{"version":3,"file":"src_js_plugins_collisions_collisions_ts.58f136d2990bbcc45575.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAsD;AAC/B;AAC+B;AACR;AAC9C;AACA;AACA,6EAA8B;AAC9B;AACA;AACA;AACO;AACP;AACA,IAAI,6CAAC,uBAAuB,gEAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,6CAAC,yBAAyB,gEAAiB;AAC/C;AACA,kDAAkD,wDAAW,CAAC;AAC9D;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC;AACL;AACA;AACA,YAAY,6CAAC;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL;AACO;AACP,eAAe,kFAAmC;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,8NAA8N,6CAAC;AAC/N;AACA;AACA;AACO;AACP;AACA;AACA;AACA,YAAY,4FAA6C;AACzD;AACA;AACA;AACA;AACA,gBAAgB,2FAA4C;AAC5D,YAAY,4FAA6C;AACzD,YAAY,6CAAC,qCAAqC,iCAAiC;AACnF;AACA;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACO;AACP,IAAI,6CAAC,qCAAqC,iCAAiC;AAC3E,IAAI,6CAAC;AACL;AACA;AACO;AACP;AACA,QAAQ,iGAAkD;AAC1D;AACA;AACA;AACO;AACP;AACA,IAAI,oEAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,oEAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,oEAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,oEAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,oEAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,4DAA4D;AAC5D,qDAAqD;AACrD,6CAA6C;AAC7C,4CAA4C;AAC5C,4CAA4C;AAC5C,6CAA6C;AAC7C,4CAA4C;AAC5C,4CAA4C;AAC5C,yEAAyE;AACzE;AACA,mCAAmC;AACnC,qCAAqC;AACrC;AACA;AACA,IAAI,mGAAoD;AACxD,IAAI,6FAA8C;AAClD,IAAI,wGAAyD;AAC7D,GAAG;AACI;AACP;AACA;AACA;AACA,YAAY,iCAAiC,EAAE,6EAA8B;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iDAAK;AACb;AACA;AACA;AACA,6CAA6C;AAC7C,QAAQ,uFAAwC,yDAAyD;AACzG,gCAAgC,2FAA4C;AAC5E,MAAM;AACN;AACO;AACP,YAAY,iCAAiC,EAAE,6EAA8B;AAC7E;AACA,wBAAwB,6CAAC,gDAAgD;AACzE,wBAAwB,6CAAC,gDAAgD;AACzE;AACA;AACA;AACA,QAAQ,6CAAC;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ,6CAAC;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA,2DAA2D;AAC3D,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,yDAAyD;AACzD,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wDAAc;AAC1B;AACA,YAAY,wDAAc;AAC1B;AACA,YAAY,wDAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6EAA8B,KAAK;AACvC","sources":["webpack://keeptrack.space/./src/js/plugins/collisions/collisions.ts"],"sourcesContent":["import socratesPng from '@app/img/icons/socrates.png';\nimport $ from 'jquery';\nimport { keepTrackApi } from '../../api/keepTrackApi';\nimport { stringPad } from '../../lib/helpers';\nlet isSocratesMenuOpen = false;\nlet socratesOnSatCruncher = null;\nkeepTrackApi.programs.socrates = {\n    socratesObjOne: [],\n    socratesObjTwo: [], // Array for tr containing CATNR2\n};\nexport const uiManagerInit = () => {\n    // Side Menu\n    $('#left-menus').append(keepTrackApi.html `\n        <div id=\"socrates-menu\" class=\"side-menu-parent start-hidden text-select\">\n          <div id=\"socrates-content\" class=\"side-menu\">\n            <div class=\"row\">\n              <h5 class=\"center-align\">Possible collisions</h5>\n              <table id=\"socrates-table\" class=\"center-align\"></table>\n            </div>\n          </div>\n        </div>\n      `);\n    $('#socrates-menu').on('click', '.socrates-object', (evt) => {\n        // Might be better code for this.\n        const hiddenRow = evt.currentTarget.attributes.hiddenrow.value;\n        if (hiddenRow !== null) {\n            socrates(hiddenRow);\n        }\n    });\n    // Bottom Icon\n    $('#bottom-icons').append(keepTrackApi.html `\n        <div id=\"menu-satellite-collision\" class=\"bmenu-item\">\n          <img alt=\"socrates\" src=\"\" delayedsrc=${socratesPng}/>\n          <span class=\"bmenu-title\">Collisions</span>\n          <div class=\"status-icon\"></div>\n        </div>\n      `);\n    // Allow resizing of the side menu\n    $('#socrates-menu').resizable({\n        handles: 'e',\n        stop: function () {\n            $(this).css('height', '');\n        },\n        maxWidth: 450,\n        minWidth: 290,\n    });\n};\nexport const adviceReady = () => {\n    const aM = keepTrackApi.programs.adviceManager;\n    aM.adviceCount.socrates = 0;\n    aM.adviceList.socrates = () => {\n        // Only Do this Twice\n        if (aM.adviceCount.socrates >= 3)\n            return;\n        aM.adviceCount.socrates += 1;\n        aM.showAdvice('SOCRATES Near Conjunction List', 'Did you know that objects frequently come close to colliding? Using data from Center for Space Standards and Innovation you can find upcoming possible collisions.', $('#menu-satellite-collision'), 'bottom');\n    };\n    aM.adviceArray.push(aM.adviceList.socrates);\n};\nexport const bottomMenuClick = (iconName) => {\n    if (iconName === 'menu-satellite-collision') {\n        if (isSocratesMenuOpen) {\n            isSocratesMenuOpen = false;\n            keepTrackApi.programs.uiManager.hideSideMenus();\n            return;\n        }\n        else {\n            if (settingsManager.isMobileModeEnabled)\n                keepTrackApi.programs.uiManager.searchToggle(false);\n            keepTrackApi.programs.uiManager.hideSideMenus();\n            $('#socrates-menu').effect('slide', { direction: 'left', mode: 'show' }, 1000);\n            isSocratesMenuOpen = true;\n            socrates(-1);\n            $('#menu-satellite-collision').addClass('bmenu-item-selected');\n            return;\n        }\n    }\n};\nexport const hideSideMenus = () => {\n    $('#socrates-menu').effect('slide', { direction: 'left', mode: 'hide' }, 1000);\n    $('#menu-satellite-collision').removeClass('bmenu-item-selected');\n    isSocratesMenuOpen = false;\n};\nexport const onCruncherMessage = () => {\n    if (socratesOnSatCruncher !== null) {\n        keepTrackApi.programs.objectManager.setSelectedSat(socratesOnSatCruncher);\n        socratesOnSatCruncher = null;\n    }\n};\nexport const init = () => {\n    // Add HTML\n    keepTrackApi.register({\n        method: 'uiManagerInit',\n        cbName: 'collisions',\n        cb: uiManagerInit,\n    });\n    // Add Advice Info\n    keepTrackApi.register({\n        method: 'adviceReady',\n        cbName: 'Collisions',\n        cb: adviceReady,\n    });\n    // Add JavaScript\n    keepTrackApi.register({\n        method: 'bottomMenuClick',\n        cbName: 'collisions',\n        cb: bottomMenuClick,\n    });\n    keepTrackApi.register({\n        method: 'hideSideMenus',\n        cbName: 'collisions',\n        cb: hideSideMenus,\n    });\n    keepTrackApi.register({\n        method: 'onCruncherMessage',\n        cbName: 'collisions',\n        cb: onCruncherMessage,\n    });\n};\nexport const MMMtoInt = (month) => {\n    switch (month) {\n        case 'Jan':\n            return 0;\n        case 'Feb':\n            return 1;\n        case 'Mar':\n            return 2;\n        case 'Apr':\n            return 3;\n        case 'May':\n            return 4;\n        case 'Jun':\n            return 5;\n        case 'Jul':\n            return 6;\n        case 'Aug':\n            return 7;\n        case 'Sep':\n            return 8;\n        case 'Oct':\n            return 9;\n        case 'Nov':\n            return 10;\n        case 'Dec':\n            return 11;\n        default:\n            throw new Error('Invalid Month');\n    }\n};\nexport const findFutureDate = (socratesObjTwo, row) => {\n    const socratesDate = socratesObjTwo[row][4].split(' '); // Date/time is on the second line 5th column\n    const socratesTime = socratesDate[3].split(':'); // Split time from date for easier management\n    const sYear = parseInt(socratesDate[0]); // UTC Year\n    const sMon = MMMtoInt(socratesDate[1]); // UTC Month in MMM prior to converting\n    const sDay = parseInt(socratesDate[2]); // UTC Day\n    const sHour = parseInt(socratesTime[0]); // UTC Hour\n    const sMin = parseInt(socratesTime[1]); // UTC Min\n    const sSec = parseInt(socratesTime[2]); // UTC Sec - This is a decimal, but when we convert to int we drop those\n    const selectedDate = new Date(sYear, sMon, sDay, sHour, sMin, sSec); // New Date object of the future collision\n    // Date object defaults to local time.\n    selectedDate.setUTCDate(sDay); // Move to UTC day.\n    selectedDate.setUTCHours(sHour); // Move to UTC Hour\n    const today = new Date();\n    // Find the offset from today 60 seconds before possible collision\n    keepTrackApi.programs.timeManager.changeStaticOffset(selectedDate.getTime() - today.getTime() - 1000 * 30);\n    keepTrackApi.programs.mainCamera.isCamSnapMode = false;\n    keepTrackApi.programs.timeManager.calculateSimulationTime();\n}; // Allows passing -1 argument to socrates function to skip these steps\nexport const socrates = (row) => {\n    if (isNaN(row))\n        throw new Error('SOCRATES: Row is not a number');\n    // SOCRATES Variables\n    const { socratesObjOne, socratesObjTwo } = keepTrackApi.programs.socrates;\n    /* SOCRATES.htm is a 20 row .pl script pulled from celestrak.com/cgi-bin/searchSOCRATES.pl\n      If it ever becomes unavailable a similar, but less accurate (maybe?) cron job could be\n      created using satCruncer.\n  \n      The variable row determines which set of objects on SOCRATES.htm we are using. First\n      row is 0 and last one is 19. */\n    if (row === -1 && socratesObjOne.length === 0 && socratesObjTwo.length === 0) {\n        // Only generate the table if receiving the -1 argument for the first time\n        $.get('/SOCRATES.htm', (socratesHTM) => processSocratesHtm(socratesHTM));\n    }\n    if (row !== -1) {\n        // If an object was selected from the menu\n        findFutureDate(socratesObjTwo, row); // Jump to the date/time of the collision\n        keepTrackApi.programs.uiManager.doSearch(socratesObjOne[row][1] + ',' + socratesObjTwo[row][0]); // Actually perform the search of the two objects\n        socratesOnSatCruncher = keepTrackApi.programs.satSet.getIdFromObjNum(socratesObjOne[row][1]);\n    } // If a row was selected\n};\nexport const processSocratesHtm = (socratesHTM) => {\n    const { socratesObjOne, socratesObjTwo } = keepTrackApi.programs.socrates;\n    // Load SOCRATES.htm so we can use it instead of index.html\n    const tableRowOne = $(\"[name='CATNR1']\", socratesHTM).closest('tr'); // Find the row(s) containing the hidden input named CATNR1\n    const tableRowTwo = $(\"[name='CATNR2']\", socratesHTM).closest('tr'); // Find the row(s) containing the hidden input named CATNR2\n    // eslint-disable-next-line no-unused-vars\n    tableRowOne.each(function (_rowIndex, _r) {\n        const cols = [];\n        $(this)\n            .find('td')\n            .each(function (_colIndex, c) {\n            cols.push(c.textContent);\n        });\n        socratesObjOne.push(cols);\n    });\n    // eslint-disable-next-line no-unused-vars\n    tableRowTwo.each(function (_rowIndex, _r) {\n        const cols = [];\n        $(this)\n            .find('td')\n            .each(function (_colIndex, c) {\n            cols.push(c.textContent);\n        });\n        socratesObjTwo.push(cols);\n    });\n    // SOCRATES Menu\n    const tbl = document.getElementById('socrates-table'); // Identify the table to update\n    tbl.innerHTML = ''; // Clear the table from old object data\n    let tr = tbl.insertRow();\n    let tdT = tr.insertCell();\n    tdT.appendChild(document.createTextNode('Time'));\n    tdT.setAttribute('style', 'text-decoration: underline');\n    let tdS1 = tr.insertCell();\n    tdS1.appendChild(document.createTextNode('#1'));\n    tdS1.setAttribute('style', 'text-decoration: underline');\n    let tdS2 = tr.insertCell();\n    tdS2.appendChild(document.createTextNode('#2'));\n    tdS2.setAttribute('style', 'text-decoration: underline');\n    for (let i = 0; i < 20; i++) {\n        if (typeof socratesObjTwo[i] == 'undefined')\n            break;\n        // 20 rows\n        if (typeof socratesObjTwo[i][4] == 'undefined')\n            continue;\n        tr = tbl.insertRow();\n        tr.setAttribute('class', 'socrates-object link');\n        tr.setAttribute('hiddenrow', i.toString());\n        tdT = tr.insertCell();\n        const socratesDate = socratesObjTwo[i][4].split(' '); // Date/time is on the second line 5th column\n        const socratesTime = socratesDate[3].split(':'); // Split time from date for easier management\n        const socratesTimeS = socratesTime[2].split('.'); // Split time from date for easier management\n        tdT.appendChild(document.createTextNode(socratesDate[2] +\n            ' ' +\n            socratesDate[1] +\n            ' ' +\n            socratesDate[0] +\n            ' - ' +\n            stringPad.pad0(socratesTime[0], 2) +\n            ':' +\n            stringPad.pad0(socratesTime[1], 2) +\n            ':' +\n            stringPad.pad0(socratesTimeS[0], 2) +\n            'Z'));\n        tdS1 = tr.insertCell();\n        tdS1.appendChild(document.createTextNode(socratesObjOne[i][1]));\n        tdS2 = tr.insertCell();\n        tdS2.appendChild(document.createTextNode(socratesObjTwo[i][0]));\n    }\n    keepTrackApi.programs.socrates = { socratesObjOne, socratesObjTwo };\n};\n"],"names":[],"sourceRoot":""}