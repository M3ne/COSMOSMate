{"version":3,"file":"src_js_plugins_photoManager_photoManager_ts.0bccb54468f8bc9b9d20.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAA8D;AACN;AACjC;AACvB;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,8FAAwC,CAAC,gGAA0C,wCAAwC,8FAAwC;AAC3K,QAAQ,iGAA2C;AACnD,+DAA+D,KAAK,GAAG,MAAM,GAAG,IAAI,OAAO,SAAS;AACpG;AACA;AACO;AACP,IAAI,kHAA4D,CAAC,mGAA6C,YAAY,sFAAgC;AAC1J,IAAI,iGAA2C;AAC/C;AACA;AACO;AACP,IAAI,kHAA4D,CAAC,mGAA6C,YAAY,sFAAgC;AAC1J,IAAI,iGAA2C;AAC/C;AACA;AACO;AACP,IAAI,kHAA4D,CAAC,mGAA6C,YAAY,sFAAgC;AAC1J,IAAI,iGAA2C;AAC/C;AACA;AACO;AACP,IAAI,kHAA4D,CAAC,mGAA6C,YAAY,sFAAgC;AAC1J,IAAI,iGAA2C;AAC/C,mBAAmB,yGAAmD,EAAE;AACxE;AACA;AACA;AACA;AACA,QAAQ,2FAAqC;AAC7C;AACA;AACA;AACA,0EAA0E;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI,sDAAU;AACd,iEAAiE,KAAK,GAAG,IAAI,GAAG,IAAI,GAAG,KAAK,EAAE,IAAI;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,6CAAC;AAC3B;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACO;AACP;AACA;AACA;AACA,KAAK;AACL,IAAI,sDAAU;AACd;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACO;AACP,IAAI,6CAAC,sCAAsC,iCAAiC;AAC5E,IAAI,6CAAC;AACL;AACA;AACO;AACP;AACA;AACA,YAAY,mGAA6C;AACzD;AACA;AACA;AACA;AACA,YAAY,mGAA6C;AACzD,YAAY,6CAAC,sCAAsC,iCAAiC;AACpF;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACO;AACP;AACA,IAAI,6CAAC,uBAAuB,uEAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC,yBAAyB,uEAAiB;AAC/C;AACA,qDAAqD,4DAAe,CAAC;AACrE;AACA;AACA;AACA;AACA;AACO;AACP;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,wFAAkC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,kHAA4D,KAAK,sFAAgC;AACrG;AACA","sources":["webpack://keeptrack.space/./src/js/plugins/photoManager/photoManager.ts"],"sourcesContent":["import photoManagerPng from '@app/img/icons/photoManager.png';\nimport { keepTrackApi } from '@app/js/api/keepTrackApi';\nimport $ from 'jquery';\nlet isSatPhotoMenuOpen = false;\nexport const dscovrLoaded = (req) => {\n    if (req.status >= 200 && req.status < 400) {\n        // Success!\n        const response = JSON.parse(req.response);\n        const imageUrl = response[0].image;\n        const dateStr = response[0].identifier;\n        const year = dateStr.slice(0, 4);\n        const month = dateStr.slice(4, 6);\n        const day = dateStr.slice(6, 8);\n        const hour = dateStr.slice(8, 10);\n        const min = dateStr.slice(10, 12);\n        const sec = dateStr.slice(12, 14);\n        // Hours are in EST? Daylight savings time might make this break\n        const dateObj = new Date(Date.UTC(year, month - 1, day, hour - 4, min, sec));\n        keepTrackApi.programs.mainCamera.camSnap(keepTrackApi.programs.mainCamera.lat2pitch(response[0].centroid_coordinates.lat), keepTrackApi.programs.mainCamera.lon2yaw(response[0].centroid_coordinates.lon, dateObj));\n        keepTrackApi.programs.mainCamera.changeZoom(0.7);\n        colorbox(`https://epic.gsfc.nasa.gov/archive/natural/${year}/${month}/${day}/png/${imageUrl}.png`);\n    }\n};\nexport const meteosat11 = () => {\n    keepTrackApi.programs.drawManager.selectSatManager.selectSat(keepTrackApi.programs.satSet.getSatFromObjNum(40732).id, keepTrackApi.programs.mainCamera);\n    keepTrackApi.programs.mainCamera.changeZoom(0.7);\n    colorbox(`https://eumetview.eumetsat.int/static-images/latestImages/EUMETSAT_MSG_RGBNatColour_LowResolution.jpg`);\n};\nexport const meteosat8 = () => {\n    keepTrackApi.programs.drawManager.selectSatManager.selectSat(keepTrackApi.programs.satSet.getSatFromObjNum(27509).id, keepTrackApi.programs.mainCamera);\n    keepTrackApi.programs.mainCamera.changeZoom(0.7);\n    colorbox(`https://eumetview.eumetsat.int/static-images/latestImages/EUMETSAT_MSGIODC_RGBNatColour_LowResolution.jpg`);\n};\nexport const goes1 = () => {\n    keepTrackApi.programs.drawManager.selectSatManager.selectSat(keepTrackApi.programs.satSet.getSatFromObjNum(41866).id, keepTrackApi.programs.mainCamera);\n    keepTrackApi.programs.mainCamera.changeZoom(0.7);\n    colorbox(`https://cdn.star.nesdis.noaa.gov/GOES16/ABI/FD/GEOCOLOR/latest.jpg`);\n};\nexport const himawari8 = () => {\n    keepTrackApi.programs.drawManager.selectSatManager.selectSat(keepTrackApi.programs.satSet.getSatFromObjNum(40267).id, keepTrackApi.programs.mainCamera);\n    keepTrackApi.programs.mainCamera.changeZoom(0.7);\n    let propTime = keepTrackApi.programs.timeManager.simulationTimeObj; // Propagation time minus 30 minutes so that the pictures have time to become available\n    if (propTime < Date.now()) {\n        propTime = new Date(propTime - 1000 * 60 * 30);\n    }\n    else {\n        keepTrackApi.programs.uiManager.toast(`Can't load pictures from the future. Loading most recent photos.`, 'caution');\n        propTime = new Date(Date.now() - 1000 * 60 * 30);\n    }\n    const year = propTime.getUTCFullYear();\n    const mon = (propTime.getUTCMonth() + 1).toString().padStart(2, '0'); // NOTE:, this function requires months in range 1-12.\n    const day = propTime.getUTCDate().toString().padStart(2, '0');\n    const hour = propTime.getUTCHours().toString().padStart(2, '0');\n    const min = (Math.floor(propTime.getUTCMinutes() / 10) * 10).toString().padStart(2, '0');\n    let imgWidth, imgHeight;\n    if (window.innerWidth < window.innerHeight) {\n        imgWidth = window.innerWidth * 0.8;\n        imgHeight = imgWidth;\n    }\n    else {\n        imgHeight = window.innerHeight * 0.8;\n        imgWidth = imgHeight;\n    }\n    settingsManager.isPreventColorboxClose = true;\n    setTimeout(function () {\n        settingsManager.isPreventColorboxClose = false;\n    }, 2000);\n    $.colorbox({\n        href: `https://himawari8.nict.go.jp/img/D531106/1d/550/${year}/${mon}/${day}/${hour}${min}00_0_0.png`,\n        photo: true,\n        width: imgWidth,\n        height: imgHeight,\n        scalePhotos: true,\n        fastIframe: false,\n        closeButton: false,\n        onComplete: () => {\n            const cbImg = $('#cboxLoadedContent img')[0];\n            cbImg.style.width = '100%';\n            cbImg.style.height = '100%';\n            cbImg.style.marginTop = '';\n        },\n    });\n};\nexport const colorbox = (url) => {\n    settingsManager.isPreventColorboxClose = true;\n    setTimeout(function () {\n        settingsManager.isPreventColorboxClose = false;\n    }, 2000);\n    $.colorbox({\n        href: url,\n        photo: true,\n        scalePhotos: true,\n        height: '80%',\n        fastIframe: false,\n        closeButton: false,\n    });\n};\nexport const hideSideMenus = () => {\n    $('#sat-photo-menu').effect('slide', { direction: 'left', mode: 'hide' }, 1000);\n    $('#menu-sat-photo').removeClass('bmenu-item-selected');\n    isSatPhotoMenuOpen = false;\n};\nexport const bottomMenuClick = (iconName) => {\n    if (iconName === 'menu-sat-photo') {\n        if (isSatPhotoMenuOpen) {\n            keepTrackApi.programs.uiManager.hideSideMenus();\n            isSatPhotoMenuOpen = false;\n            return;\n        }\n        else {\n            keepTrackApi.programs.uiManager.hideSideMenus();\n            $('#sat-photo-menu').effect('slide', { direction: 'left', mode: 'show' }, 1000);\n            isSatPhotoMenuOpen = true;\n            $('#menu-sat-photo').addClass('bmenu-item-selected');\n            return;\n        }\n    }\n};\nexport const uiManagerInit = () => {\n    // Side Menu\n    $('#left-menus').append(keepTrackApi.html `\n        <div id=\"sat-photo-menu\" class=\"side-menu-parent start-hidden text-select\">\n          <div id=\"sat-photo-menu-content\" class=\"side-menu\">\n            <ul>\n              <h5 class=\"center-align\">Satellites Imagery List</h5>\n              <li class=\"link satPhotoRow\" onmouseup=\"keepTrackApi.programs.photoManager.meteosat8()\">MeteoSat 8</li>\n              <li class=\"link satPhotoRow\" onmouseup=\"keepTrackApi.programs.photoManager.meteosat11()\">MeteoSat 11</li>\n              <li class=\"link satPhotoRow\" onmouseup=\"keepTrackApi.programs.photoManager.himawari8()\">Himawari 8</li>\n              <li class=\"link satPhotoRow\" onmouseup=\"keepTrackApi.programs.photoManager.discovr()\">DSCOVR</li>\n              <li class=\"link satPhotoRow\" onmouseup=\"keepTrackApi.programs.photoManager.goes1()\">GOES 1</li>\n            </ul>\n          </div>\n        </div>\n      `);\n    // Bottom Icon\n    $('#bottom-icons').append(keepTrackApi.html `\n        <div id=\"menu-sat-photo\" class=\"bmenu-item\">\n          <img alt=\"photographs\" src=\"\" delayedsrc=${photoManagerPng}/>\n          <span class=\"bmenu-title\">Satellite Photos</span>\n          <div class=\"status-icon\"></div>\n        </div>\n      `);\n};\nexport const init = () => {\n    // Add HTML\n    keepTrackApi.register({\n        method: 'uiManagerInit',\n        cbName: 'photoManager',\n        cb: uiManagerInit,\n    });\n    // Add JavaScript\n    keepTrackApi.register({\n        method: 'bottomMenuClick',\n        cbName: 'photoManager',\n        cb: bottomMenuClick,\n    });\n    keepTrackApi.register({\n        method: 'hideSideMenus',\n        cbName: 'photoManager',\n        cb: hideSideMenus,\n    });\n    keepTrackApi.programs.photoManager = {\n        meteosat8: meteosat8,\n        meteosat11: meteosat11,\n        goes1: goes1,\n        himawari8: himawari8,\n        discovr: discovr,\n    };\n};\nexport const discovr = () => {\n    const request = new XMLHttpRequest();\n    request.open('GET', `https://epic.gsfc.nasa.gov/api/natural`, true);\n    request.onload = () => {\n        dscovrLoaded(request);\n    };\n    request.onerror = function () {\n        console.debug('https://epic.gsfc.nasa.gov/ request failed!');\n    };\n    keepTrackApi.programs.drawManager.selectSatManager.selectSat(-1, keepTrackApi.programs.mainCamera);\n    request.send();\n};\n"],"names":[],"sourceRoot":""}