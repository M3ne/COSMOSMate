{"version":3,"file":"src_js_plugins_externalSources_externalSources_ts.53ff910904575b87b3d6.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACwD;AACjC;AACvB;AACO;AACP,IAAI,6CAAC,qCAAqC,iCAAiC;AAC3E,IAAI,6CAAC;AACL;AACA;AACO;AACP;AACA,IAAI,6CAAC,uBAAuB,uEAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mIAAmI;AACnI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wIAAwI;AACxI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC,yBAAyB,uEAAiB;AAC/C;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC;AACL;AACA;AACA,KAAK;AACL,IAAI,6CAAC;AACL;AACA;AACA,KAAK;AACL,IAAI,6CAAC;AACL;AACA;AACA,YAAY,6CAAC;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL;AACO;AACP,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACO;AACP,IAAI,6CAAC;AACL,gCAAgC,6CAAC;AACjC;AACA,QAAQ,6CAAC;AACT,KAAK;AACL;AACO;AACP,YAAY,SAAS,EAAE,2EAAqB;AAC5C,YAAY,UAAU,EAAE,kFAA4B;AACpD;AACA;AACA,4BAA4B,oBAAoB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;AACO;AACP,YAAY,oBAAoB,EAAE,2EAAqB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,YAAY,EAAE,2EAAqB;AAC/C;AACA;AACA;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACA;AACA,YAAY,6CAAC,qCAAqC,iCAAiC;AACnF,YAAY,qGAA+C;AAC3D;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACO;AACP,YAAY,oBAAoB,EAAE,2EAAqB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,kBAAkB;AAClF;AACA,gEAAgE,kBAAkB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,SAAS,EAAE,2EAAqB;AAC5C,oBAAoB,0FAAoC;AACxD;AACA;AACA,4BAA4B,oBAAoB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;AACO;AACP,IAAI,6CAAC;AACL,gCAAgC,6CAAC;AACjC;AACA,QAAQ,6CAAC;AACT,KAAK;AACL","sources":["webpack://keeptrack.space/./src/js/plugins/externalSources/externalSources.ts"],"sourcesContent":["/**\n * /////////////////////////////////////////////////////////////////////////////\n *\n * externalSources.ts is a plugin to allow downloading and parsing of external\n * data sources from the internet.\n *\n * http://keeptrack.space\n *\n * @Copyright (C) 2016-2021 Theodore Kruczek\n *\n * KeepTrack is free software: you can redistribute it and/or modify it under\n * the terms of the GNU General Public License as published by the Free Software\n * Foundation, either version 3 of the License, or (at your option) any later version.\n *\n * KeepTrack is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.\n * You should have received a copy of the GNU General Public License along with\n * KeepTrack. If not, see <http://www.gnu.org/licenses/>.\n *\n * TESTING: This plugin requires php to be installed on the server. It won't work\n * with the default http npm module.\n *\n * /////////////////////////////////////////////////////////////////////////////\n */\nimport { keepTrackApi } from '@app/js/api/keepTrackApi';\nimport $ from 'jquery';\nlet isExternalMenuOpen = false;\nexport const hideSideMenus = () => {\n    $('#external-menu').effect('slide', { direction: 'left', mode: 'hide' }, 1000);\n    $('#menu-external').removeClass('bmenu-item-selected');\n    isExternalMenuOpen = false;\n};\nexport const uiManagerInit = () => {\n    // Side Menu\n    $('#left-menus').append(keepTrackApi.html `\n        <div id=\"external-menu\" class=\"side-menu-parent start-hidden text-select\">\n          <div id=\"external-inner-menu\" class=\"side-menu\">\n            <ul>\n              <h5 class=\"center-align\">External TLE Menu</h5>\n              <li class=\"divider\"></li>\n            </ul>\n            <h5 class=\"center-align\">N2YO Lookup</h5>\n            <li class=\"divider\"></li>\n            <div class=\"row\"></div>\n            <form id=\"n2yo-form\">\n              <div class=\"row\">\n                <div class=\"input-field col s12\">\n                  <input value=\"25544\" id=\"ext-n2yo\" type=\"text\" />\n                  <label for=\"anal-sat\" class=\"active\">Satellite Number</label>\n                </div>\n              </div>\n              <div class=\"row\">\n                <center>\n                  <button id=\"n2yo-submit\" class=\"btn btn-ui waves-effect waves-light\" type=\"submit\" name=\"action\">Load TLE &#9658;</button>\n                </center>\n              </div>\n            </form>\n            <h5 class=\"center-align\">Celestrak Lookup</h5>\n            <li class=\"divider\"></li>\n            <div class=\"row\"></div>\n            <form id=\"celestrak-form\">\n              <div class=\"row\">\n                <div class=\"input-field col s12\">\n                  <input value=\"25544\" id=\"ext-celestrak\" type=\"text\" />\n                  <label for=\"anal-sat\" class=\"active\">Satellite Number</label>\n                </div>\n              </div>\n              <div class=\"row\">\n                <center>\n                  <button id=\"celestrak-submit\" class=\"btn btn-ui waves-effect waves-light\" type=\"submit\" name=\"action\">Load TLE &#9658;</button>\n                </center>\n              </div>\n            </form>\n          </div>\n        </div>\n      `);\n    // Bottom Icon\n    $('#bottom-icons').append(keepTrackApi.html `\n        <div id=\"menu-external\" class=\"bmenu-item\">\n          <img\n            alt=\"external\"\n            src=\"\"\n            delayedsrc=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAACS0lEQVR4nO3cPW4TURSG4fdGCCkKO7HshqFLgeiCxH7SxZReDymygKTCTTAusg6Q8mPhS4GCLMBxzMydc+6Z7yljR558r8YeW1ZARERERERERERERKS4ZH0ApYznOff1WIsm/feOB10eiOxPAYwpgDEFMKYAxsJeBbUxuc5HecU58PY599dVUIf2Hb8tBdjQ9/igAL9ZjA8KAMBomV+tV1zwxPgZLks89uADTK7z0cEtnxIcb7tPgqvVHe9LPP6LNr/c5+ct+8iJ6dfX6eOu+z3naSfB1f0dJzfH6dt43v2fG+4MKDV+pwe5IVSA2saHQAFqHB+CBKh1fAgQoObxoeVV0DZtPhspwev4EOAM2MXz+BA8gPfxIXCAGsaHoAFqGR8CBqhpfAgWoLbxIVCAGseHIAFqHR8KvRHrU9fjTz7n6Zc3afqv20q8waz6DCgxfk6cdXqQO1QbIML4UGmAKONDhQEijQ+VBYg2PlQUoMSlpvX4UEmAmq/zd3EfIPL44DxA9PHBcYAhjA9OAwxlfHAYYEjjg7MAQxsfHAUY4vjg5OPo0TK/XN9y8dRXxDNcrg85uWnS9z6PrTQXZ8BylB4SnG+7/fH7+ctRrPHBSQCARZNmwOmfP4/4tLPJTQD4O0L08cHJa8CmRZNm43kmwYfo44OzM+DRokmzH4e8iz4+OA0Av16YrY+hD24DDIUCGFMAYwpgTAGMKYAxBTCmAMYUwJgCGFMAY0U+DfX6f4Q80hlgTAGMKYAxBTCmACIiIiIiIiIiIiIi8f0EO/G3ftHy+QwAAAAASUVORK5CYII=\"\n          />\n          <span class=\"bmenu-title\">External Source</span>\n          <div class=\"status-icon\"></div>\n        </div>\n      `);\n    $('#n2yo-form').on('submit', function (e) {\n        n2yoFormSubmit();\n        e.preventDefault();\n    });\n    $('#celestrak-form').on('submit', function (e) {\n        celestrakFormSubmit();\n        e.preventDefault();\n    });\n    $('#external-menu').resizable({\n        handles: 'e',\n        stop: function () {\n            $(this).css('height', '');\n        },\n        maxWidth: 450,\n        minWidth: 280,\n    });\n};\nexport const init = () => {\n    keepTrackApi.register({\n        method: 'uiManagerInit',\n        cbName: 'externalSources',\n        cb: uiManagerInit,\n    });\n    // Add JavaScript\n    keepTrackApi.register({\n        method: 'bottomMenuClick',\n        cbName: 'externalSources',\n        cb: bottomMenuClick,\n    });\n    keepTrackApi.register({\n        method: 'hideSideMenus',\n        cbName: 'externalSources',\n        cb: hideSideMenus,\n    });\n};\nexport const n2yoFormSubmit = () => {\n    $('#loading-screen').fadeIn(1000, function () {\n        const satnum = parseInt($('#ext-n2yo').val());\n        searchN2yo(satnum);\n        $('#loading-screen').fadeOut('slow');\n    });\n};\nexport const searchN2yo = (satNum, analsat) => {\n    const { satSet } = keepTrackApi.programs;\n    const { satData } = keepTrackApi.programs.satSet;\n    // If no Analyst Satellite specified find the first unused one\n    if (typeof analsat == 'undefined') {\n        for (let i = 15000; i < satData.length; i++) {\n            if (parseInt(satData[i].sccNum) >= 80000 && !satData[i].active) {\n                analsat = i;\n                break;\n            }\n        }\n    }\n    else {\n        // Satnum to Id\n        analsat = satSet.getIdFromObjNum(analsat);\n    }\n    const request = new XMLHttpRequest();\n    request.open('GET', `php/get_data.php?type=n&sat=${satNum}`, true);\n    request.onload = () => searchN2yoOnLoad(request, analsat);\n    request.send();\n};\nexport const searchN2yoOnLoad = (request, analsat) => {\n    const { satSet, uiManager } = keepTrackApi.programs;\n    if (request.status >= 200 && request.status < 400) {\n        // Success!\n        const tles = request.response.split('<div id=\"tle\">')[1].split('<pre>')[1].split('\\n');\n        const TLE1 = tles[1];\n        const TLE2 = tles[2];\n        if (TLE1.substr(0, 2) !== '1 ')\n            throw new Error('N2YO TLE 1 is not a valid TLE');\n        if (TLE2.substr(0, 2) !== '2 ')\n            throw new Error('N2YO TLE 2 is not a valid TLE');\n        const sat = satSet.insertNewAnalystSatellite(TLE1, TLE2, analsat);\n        uiManager.doSearch(sat.sccNum.toString());\n    }\n    else {\n        // We reached our target server, but it returned an error\n        // console.debug('N2YO request returned an error!');\n    }\n};\nexport const bottomMenuClick = (iconName) => {\n    const { uiManager } = keepTrackApi.programs;\n    if (iconName === 'menu-external') {\n        if (isExternalMenuOpen) {\n            isExternalMenuOpen = false;\n            $('#menu-external').removeClass('bmenu-item-selected');\n            uiManager.hideSideMenus();\n            return;\n        }\n        else {\n            uiManager.hideSideMenus();\n            $('#external-menu').effect('slide', { direction: 'left', mode: 'show' }, 1000);\n            keepTrackApi.programs.watchlist.updateWatchlist();\n            isExternalMenuOpen = true;\n            $('#menu-external').addClass('bmenu-item-selected');\n            return;\n        }\n    }\n};\nexport const searchCelestrackOnLoad = (request, analsat) => {\n    const { satSet, uiManager } = keepTrackApi.programs;\n    if (request.status >= 200 && request.status < 400) {\n        // Success!\n        const tles = JSON.parse(request.response).split('\\n');\n        const TLE1 = tles[1];\n        const TLE2 = tles[2];\n        if (TLE1.substr(0, 2) !== '1 ')\n            throw new Error(`N2YO TLE 1 is not a valid TLE -- ${TLE1.substr(0, 2)}`);\n        if (TLE2.substr(0, 2) !== '2 ')\n            throw new Error(`N2YO TLE 2 is not a valid TLE -- ${TLE2.substr(0, 2)}`);\n        const sat = satSet.insertNewAnalystSatellite(TLE1, TLE2, analsat);\n        uiManager.doSearch(sat.sccNum.toString());\n    }\n    else {\n        // We reached our target server, but it returned an error\n        // console.debug('Celestrack request returned an error!');\n    }\n};\nexport const searchCelestrak = (satNum, analsat) => {\n    const { satSet } = keepTrackApi.programs;\n    const satData = keepTrackApi.programs.satSet.satData;\n    // If no Analyst Satellite specified find the first unused one\n    if (typeof analsat == 'undefined') {\n        for (let i = 15000; i < satData.length; i++) {\n            if (parseInt(satData[i].sccNum) >= 80000 && !satData[i].active) {\n                analsat = i;\n                break;\n            }\n        }\n    }\n    else {\n        // Satnum to Id\n        analsat = satSet.getIdFromObjNum(analsat);\n    }\n    const request = new XMLHttpRequest();\n    request.open('GET', `php/get_data.php?type=c&sat=${satNum}`, true);\n    request.onload = () => searchCelestrackOnLoad(request, analsat);\n    request.send();\n};\nexport const celestrakFormSubmit = () => {\n    $('#loading-screen').fadeIn(1000, function () {\n        const satnum = parseInt($('#ext-celestrak').val());\n        searchCelestrak(satnum);\n        $('#loading-screen').fadeOut('slow');\n    });\n};\n"],"names":[],"sourceRoot":""}