{"version":3,"file":"src_js_plugins_initialOrbit_initialOrbit_ts.7c7f27625e41cd7dd2bb.js","mappings":"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MF,KAAK,GAAG,CAACsH,GAAD,EAAMzG,GAAN,KAAe,CAAAyG,GAAG,SAAH,IAAAA,GAAG,WAAH,YAAAA,GAAG,CAAE5G,MAAL,IAAcG,GAAd,GAAoBb,KAAK,CAAC,MAAMsH,GAAP,EAAYzG,GAAZ,CAAzB,GAA4CyG,GAAzE;AAEA,IAAMC,SAAS,GAAGjK,EAAlB;;;;;;;;;;;;;;;;;;;;;;;AC1biD;AACc;AAC/C;AACqB;AAC5C;AACO;AACP;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACO;AACP,IAAI,6CAAC,kCAAkC,iCAAiC;AACxE,IAAI,6CAAC;AACL;AACA;AACO;AACP;AACA,IAAI,6CAAC,uBAAuB,uEAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC,yBAAyB,uEAAiB;AAC/C;AACA;AACA;AACA;AACA,qBAAqB,mDAAM,CAAC;AAC5B;AACA;AACA;AACA;AACA,IAAI,6CAAC;AACL;AACA;AACA,YAAY,6CAAC;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL,IAAI,6CAAC;AACL;AACA,KAAK;AACL;AACO;AACP,YAAY,YAAY,EAAE,2EAAqB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,6CAAC,kCAAkC,iCAAiC;AAChF;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACO;AACP,YAAY,4CAA4C,EAAE,2EAAqB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,4FAAqB;AACzB;AACA;AACA","sources":["webpack://keeptrack.space/./src/js/plugins/initialOrbit/omManager.js","webpack://keeptrack.space/./src/js/plugins/initialOrbit/initialOrbit.ts"],"sourcesContent":["/* eslint-disable no-unused-vars */\n/* /////////////////////////////////////////////////////////////////////////////\n\nomManager.js Orbit Math Manager handles the conversion of state vector data,\nkeplerian elements, and two line element sets as well as initial orbit fitting\nhttp://keeptrack.space\n\nCopyright (C) 2016-2022 Theodore Kruczek\nCopyright (C) 2020 Heather Kruczek\n\nThis program is free software: you can redistribute it and/or modify it under\nthe terms of the GNU General Public License as published by the Free Software\nFoundation, either version 3 of the License, or (at your option) any later version.\n\nThis program is distributed in the hope that it will be useful, but WITHOUT\nANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\nFOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.\n\n///////////////////////////////////////////////////////////////////////////// */\n\n// sv - State Vectors\n// [unixTime, x, y, z, xDot, yDot, zDot]\n\n// TODO: This library needs rewrote in TypeScript\n// TODO: Reference older version of this file for possible additional features\n\n'use strict';\n\nimport { searchBox } from '@app/js/uiManager/searchBox';\n\n// Constants\nconst RADIUS_OF_EARTH = 6371000; // Radius of Earth in meters\nconst G = 6.6725985e-11;\nconst MILLISECONDS_PER_DAY = 1.15741e-8;\nconst MINUTES_PER_DAY = 1440;\nconst PI = Math.PI;\nconst TAU = 2 * PI;\nconst RAD2DEG = 360 / TAU;\n\n// Make Orbit Math Manager\nlet om = {};\n\n// Public Functions\nom.sat2sv = (sat, timeManager) => [timeManager.calculateSimulationTime(), sat.position.x, sat.position.y, sat.position.z, sat.velocity.x, sat.velocity.y, sat.velocity.z];\nom.sat2kp = (sat, timeManager) => {\n  const sv = om.sat2sv(sat, timeManager);\n  return om.sv2kp(sv, timeManager);\n};\nom.sat2tle = (sat, timeManager) => {\n  const kp = om.sat2kp(sat, timeManager);\n  return om.kp2tle(kp, null, timeManager);\n};\nom.sv2kp = (sv) => {\n  const kepler = _sv2kp(1, 1, sv, 'kg', 'M_Earth', [0, 0, 0, 0, 0, 0], 'km', 'm');\n  return kepler;\n};\nom.kp2tle = (kp, epoch, timeManager) => {\n  const inc = kp.inclination;\n  const raan = kp.raan;\n  const ecc = kp.eccentricity;\n  const argpe = kp.argPe;\n  const meana = kp.mo;\n  const meanmo = 1440 / kp.period;\n  epoch = typeof epoch == 'undefined' || epoch == null ? new Date(timeManager.calculateSimulationTime()) : epoch;\n  const yy = epoch.getUTCFullYear() - 2000; // This won't work before year 2000, but that shouldn't matter\n  let epochd = _dayOfYear(epoch.getUTCMonth(), epoch.getUTCDate(), epoch.getUTCHours(), epoch.getUTCMinutes(), epoch.getUTCSeconds());\n  epochd = epochd * 1 + epoch.getUTCMilliseconds() * MILLISECONDS_PER_DAY;\n  const tle1 = `1 80000U 58001A   ${yy}${_pad0(parseFloat(epochd).toFixed(8), 12)} 0.00000000 +00000-0 +00000-0 0 99990`;\n  const tle2 = `2 80000 ${_pad0(inc.toFixed(4), 8)} ${_pad0(raan.toFixed(4), 8)} ${ecc.toPrecision(7).substr(2, 7)} ${_pad0(parseFloat(argpe).toFixed(4), 8)} ${_pad0(meana.toFixed(4), 8)} ${_pad0(meanmo.toFixed(8), 11)}000010`;\n  return { tle1: tle1, tle2: tle2 };\n};\n// State Vectors to Keplerian Min/Max/Avg\nom.svs2kps = (svs) => { // NOSONAR\n  let kpList = [];\n  for (let i = 0; i < svs.length; i++) {\n    kpList.push(om.sv2kp(svs[i]));\n  }\n\n  // Results\n  let r = {};\n  {\n    r.max = {};\n    r.max.apogee = 0;\n    r.max.argPe = 0;\n    r.max.eccentricity = 0;\n    r.max.inclination = 0;\n    r.max.mo = 0;\n    r.max.perigee = 0;\n    r.max.period = 0;\n    r.max.raan = 0;\n    r.max.semiMajorAxis = 0;\n    r.max.ta = 0;\n    r.max.tl = 0;\n    r.min = {};\n    r.min.apogee = 1000000;\n    r.min.argPe = 1000000;\n    r.min.eccentricity = 1000000;\n    r.min.inclination = 1000000;\n    r.min.mo = 1000000;\n    r.min.perigee = 1000000;\n    r.min.period = 1000000;\n    r.min.raan = 1000000;\n    r.min.semiMajorAxis = 1000000;\n    r.min.ta = 1000000;\n    r.min.tl = 1000000;\n    r.avg = {};\n    r.avg.apogee = 0;\n    r.avg.argPe = 0;\n    r.avg.eccentricity = 0;\n    r.avg.inclination = 0;\n    r.avg.mo = 0;\n    r.avg.perigee = 0;\n    r.avg.period = 0;\n    r.avg.raan = 0;\n    r.avg.semiMajorAxis = 0;\n    r.avg.ta = 0;\n    r.avg.tl = 0;\n  }\n\n  // deepcode ignore UnusedIterator: false positive\n  for (let i = 0; i < kpList.length; i++) {\n    if (kpList[i].apogee < r.min.apogee) r.min.apogee = kpList[i].apogee;\n    if (kpList[i].apogee > r.max.apogee) r.max.apogee = kpList[i].apogee;\n    r.avg.apogee += kpList[i].apogee;\n    if (kpList[i].argPe < r.min.argPe) r.min.argPe = kpList[i].argPe;\n    if (kpList[i].argPe > r.max.argPe) r.max.argPe = kpList[i].argPe;\n    r.avg.argPe += kpList[i].argPe;\n    if (kpList[i].eccentricity < r.min.eccentricity) r.min.eccentricity = kpList[i].eccentricity;\n    if (kpList[i].eccentricity > r.max.eccentricity) r.max.eccentricity = kpList[i].eccentricity;\n    r.avg.eccentricity += kpList[i].eccentricity;\n    if (kpList[i].inclination < r.min.inclination) r.min.inclination = kpList[i].inclination;\n    if (kpList[i].inclination > r.max.inclination) r.max.inclination = kpList[i].inclination;\n    r.avg.inclination += kpList[i].inclination;\n    if (kpList[i].mo < r.min.mo) r.min.mo = kpList[i].mo;\n    if (kpList[i].mo > r.max.mo) r.max.mo = kpList[i].mo;\n    r.avg.mo += kpList[i].mo;\n    if (kpList[i].perigee < r.min.perigee) r.min.perigee = kpList[i].perigee;\n    if (kpList[i].perigee > r.max.perigee) r.max.perigee = kpList[i].perigee;\n    r.avg.perigee += kpList[i].perigee;\n    if (kpList[i].period < r.min.period) r.min.period = kpList[i].period;\n    if (kpList[i].period > r.max.period) r.max.period = kpList[i].period;\n    r.avg.period += kpList[i].period;\n    if (kpList[i].raan < r.min.raan) r.min.raan = kpList[i].raan;\n    if (kpList[i].raan > r.max.raan) r.max.raan = kpList[i].raan;\n    r.avg.raan += kpList[i].raan;\n    if (kpList[i].semiMajorAxis < r.min.semiMajorAxis) r.min.semiMajorAxis = kpList[i].semiMajorAxis;\n    if (kpList[i].semiMajorAxis > r.max.semiMajorAxis) r.max.semiMajorAxis = kpList[i].semiMajorAxis;\n    r.avg.semiMajorAxis += kpList[i].semiMajorAxis;\n    if (kpList[i].ta < r.min.ta) r.min.ta = kpList[i].ta;\n    if (kpList[i].ta > r.max.ta) r.max.ta = kpList[i].ta;\n    r.avg.ta += kpList[i].ta;\n    if (kpList[i].tl < r.min.tl) r.min.tl = kpList[i].tl;\n    if (kpList[i].tl > r.max.tl) r.max.tl = kpList[i].tl;\n    r.avg.tl += kpList[i].tl;\n  }\n\n  r.avg.apogee /= kpList.length;\n  r.avg.argPe /= kpList.length;\n  r.avg.eccentricity /= kpList.length;\n  r.avg.inclination /= kpList.length;\n  r.avg.mo /= kpList.length;\n  r.avg.perigee /= kpList.length;\n  r.avg.period /= kpList.length;\n  r.avg.raan /= kpList.length;\n  r.avg.semiMajorAxis /= kpList.length;\n  r.avg.ta /= kpList.length;\n  r.avg.tl /= kpList.length;\n\n  return r;\n};\nom.iod = async (svs, timeManager, satellite) => {\n  try {\n    const kps = om.svs2kps(svs);\n\n    // Sort SVs by Time\n    svs.sort(function (a, b) {\n      return a[0].value - b[0].value;\n    });\n\n    // Change Time to Relative to the First Observation\n    const epoch = new Date(svs[0][0]);\n\n    return om.fitTles(epoch, svs, kps, timeManager, satellite);\n  } catch (e) {\n    console.debug(e);\n  }\n};\n\nom.fitTles = async (epoch, svs, kps, timeManager, satellite) => { // NOSONAR\n  try {\n    om.debug.closestApproach = 0;\n    const STEPS = settingsManager.fitTleSteps;\n    const raanI = (kps.max.raan - kps.min.raan) / STEPS;\n    const argpeI = (kps.max.argPe - kps.min.argPe) / STEPS;\n    const meanaI = (kps.max.mo - kps.min.mo) / STEPS;\n    // DEBUG:\n    // const incI = (kps.max.inclination - kps.min.inclination) / STEPS;\n    // const eccI = (kps.max.eccentricity - kps.min.eccentricity) / STEPS;\n    // const periodI = (kps.max.period - kps.min.period) / STEPS;\n    let bestIndicies = [10000000]; // Starts Really Large To Ensure First One is Better\n\n    for (let r = -STEPS / 2; r < STEPS / 2; r++) {\n      for (let a = -STEPS; a < STEPS; a++) {\n        for (let m = -STEPS * 2; m < STEPS * 2; m++) {\n          const possibleKp = {};\n          possibleKp.inclination = kps.avg.inclination;\n          possibleKp.raan = kps.avg.raan + raanI * r;\n          possibleKp.eccentricity = kps.avg.eccentricity;\n          possibleKp.argPe = kps.avg.argPe + argpeI * a;\n          possibleKp.mo = kps.avg.mo + (meanaI * m) / 2;\n          possibleKp.period = kps.avg.period;\n          const tles = om.kp2tle(possibleKp, epoch, timeManager);\n          let xError = 0;\n          let yError = 0;\n          let zError = 0;\n          let posErrorAvg = 0;\n          for (let svI = 0; svI < svs.length; svI++) {\n            let eci;\n            try {\n              eci = _propagate(tles.tle1, tles.tle2, new Date(epoch + (svs[svI][0] - svs[0][0])), satellite);\n              xError += Math.abs(eci.position.x - svs[svI][1]);\n              yError += Math.abs(eci.position.y - svs[svI][2]);\n              zError += Math.abs(eci.position.z - svs[svI][3]);\n              posErrorAvg += Math.sqrt(xError ** 2 + yError ** 2 + zError ** 2);\n            } catch (error) {\n              // DEBUG:\n              // console.warn(eci);\n            }\n          }\n          posErrorAvg /= svs.length;\n\n          // TODO: Better Decision on Best Indicies\n          if (posErrorAvg < bestIndicies[0]) {\n            bestIndicies = [posErrorAvg, r, a, m];\n          }\n        }\n      }\n    }\n    // debug\n    console.log(`Closest Approach: ${bestIndicies[0]}`);\n    om.debug.closestApproach += bestIndicies[0];\n\n    // Calculate Best TLE\n    let kp = {};\n    kp.inclination = kps.avg.inclination;\n    kp.raan = kps.avg.raan + raanI * bestIndicies[1];\n    kp.eccentricity = kps.avg.eccentricity;\n    kp.argPe = kps.avg.argPe + argpeI * bestIndicies[2];\n    kp.mo = kps.avg.mo + meanaI * bestIndicies[3];\n    kp.period = kps.avg.period;\n    return om.kp2tle(kp, epoch);\n  } catch (e) {\n    console.debug(e);\n  }\n};\nom.svs2analyst = async (svs, satSet, timeManager, satellite) => {\n  om.iod(svs, timeManager, satellite)\n    .then((tles) => {\n      satSet.insertNewAnalystSatellite(tles.tle1, tles.tle2, satSet.getIdFromObjNum(100500), '100500'); // TODO: Calculate unused analyst satellite and use that Instead\n      searchBox.doSearch('100500', true);\n    })\n    .catch((error) => {\n      console.debug(error);\n    });\n};\n\nom.testIod = (satSet) => {\n  fetch('/metObs.json')\n    .then((response) => response.json())\n    .then((metObs) => {\n      for (let i = 0; i < metObs.length; i++) {\n        let svs = metObs[i];\n        om.svs2analyst(svs, satSet);\n      }\n      om.debug.closestApproach /= metObs.length;\n      console.log(`Average Approach: ${om.debug.closestApproach}`);\n    })\n    .catch((error) => {\n      console.debug(error);\n    });\n};\n\nom.debug = {};\nom.debug.closestApproach = 0;\n\nexport const _propagate = async (tle1, tle2, epoch, satellite) => {\n  try {\n    let satrec = satellite.twoline2satrec(tle1, tle2); // perform and store sat init calcs\n    let j = _jday(\n      epoch.getUTCFullYear(),\n      epoch.getUTCMonth() + 1, // NOTE:, this function requires months in range 1-12.\n      epoch.getUTCDate(),\n      epoch.getUTCHours(),\n      epoch.getUTCMinutes(),\n      epoch.getUTCSeconds()\n    ); // Converts time to jday (TLEs use epoch year/day)\n    j += epoch.getUTCMilliseconds() * MILLISECONDS_PER_DAY;\n\n    let m = (j - satrec.jdsatepoch) * MINUTES_PER_DAY;\n    let eci = satellite.sgp4(satrec, m);\n    return eci;\n } catch (error) {\n    // intentionally left blank\n  }\n};\nexport const _jday = (year, mon, day, hr, minute, sec) => {\n  'use strict';\n  return (\n    367.0 * year - Math.floor(7 * (year + Math.floor((mon + 9) / 12.0)) * 0.25) + Math.floor((275 * mon) / 9.0) + day + 1721013.5 + ((sec / 60.0 + minute) / 60.0 + hr) / 24.0 //  ut in days\n  );\n};\n// Converts State Vectors to Keplerian Elements\nexport const _sv2kp = (massPrimary, massSecondary, vector, massPrimaryU, massSecondaryU, vectorU, outputU, outputU2) => { // NOSONAR\n  let rx = vector[1] * 1000;\n  let ry = vector[2] * 1000;\n  let rz = vector[3] * 1000;\n  let vx = vector[4] * 1000;\n  let vy = vector[5] * 1000;\n  let vz = vector[6] * 1000;\n  \n  if (massSecondaryU === 'M_Earth') {\n    massSecondary = massSecondary * 5.97378250603408e24;\n  }\n\n  // Prevent divide by 0 errors\n  if (rx === 0) {\n    rx = 0.000000000000001;\n  }\n  if (ry === 0) {\n    ry = 0.000000000000001;\n  }\n  if (rz === 0) {\n    rz = 0.000000000000001;\n  }\n  if (vx === 0) {\n    vx = 0.000000000000001;\n  }\n  if (vy === 0) {\n    vy = 0.000000000000001;\n  }\n  if (vz === 0) {\n    vz = 0.000000000000001;\n  }\n\n  let mu = G * (massPrimary + massSecondary);\n\n  let r = Math.sqrt(rx * rx + ry * ry + rz * rz);\n  let v = Math.sqrt(vx * vx + vy * vy + vz * vz);\n  let a = 1 / (2 / r - (v * v) / mu); //  semi-major axis\n\n  let hx = ry * vz - rz * vy;\n  let hy = rz * vx - rx * vz;\n  let hz = rx * vy - ry * vx;\n  let h = Math.sqrt(hx * hx + hy * hy + hz * hz);\n\n  let p = (h * h) / mu;\n  let q = rx * vx + ry * vy + rz * vz; // dot product of r*v\n\n  let e = Math.sqrt(1 - p / a); // eccentricity\n\n  let ex = 1 - r / a;\n  let ey = q / Math.sqrt(a * mu);\n\n  let i = Math.acos(hz / h);\n  let lan = 0;\n  if (i != 0) {\n    lan = _arctan2(hx, -hy);\n  }\n\n  let tax = (h * h) / (r * mu) - 1;\n  let tay = (h * q) / (r * mu);\n  let ta = _arctan2(tay, tax);\n  let cw = (rx * Math.cos(lan) + ry * Math.sin(lan)) / r;\n\n  let sw = 0;\n  if (i === 0 || i === PI) {\n    sw = (ry * Math.cos(lan) - rx * Math.sin(lan)) / r;\n  } else {\n    sw = rz / (r * Math.sin(i));\n  }\n\n  let w = _arctan2(sw, cw) - ta;\n  if (w < 0) {\n    w = TAU + w;\n  }\n\n  let u = _arctan2(ey, ex); // eccentric anomoly\n  let m = u - e * Math.sin(u); // Mean anomoly\n  let tl = w + ta + lan; // True longitude\n\n  while (tl >= TAU) {\n    tl = tl - TAU;\n  }\n\n  const PlusMinus = a * e;\n  const periapsis = a - PlusMinus - RADIUS_OF_EARTH;\n  const apoapsis = a + PlusMinus - RADIUS_OF_EARTH;\n  const period = TAU * Math.sqrt((a * a * a) / (G * (massPrimary + massSecondary)));\n\n  // toDegrees\n  i = RAD2DEG * i;\n  lan = RAD2DEG * lan;\n  w = RAD2DEG * w;\n  m = RAD2DEG * m;\n  ta = RAD2DEG * ta;\n  tl = RAD2DEG * tl;\n\n  return {\n    semiMajorAxis: a,\n    eccentricity: e,\n    inclination: i,\n    raan: lan,\n    argPe: w,\n    mo: m,\n    ta,\n    tl,\n    perigee: periapsis,\n    apogee: apoapsis,\n    period,\n  };\n};\n\n// Internal Functions\nexport const _arctan2 = (y, x) => {\n  let u;\n  if (x != 0) {\n    u = Math.atan(y / x);\n    if (x < 0) u = u + PI;\n    if (x > 0 && y < 0) u = u + TAU;\n  } else {\n    if (y < 0) u = -PI / 2;\n    if (y === 0) u = 0;\n    if (y > 0) u = PI / 2;\n  }\n  return u;\n};\nexport const _dayOfYear = (mon, day, hr, minute, sec) =>\n  // eslint-disable-next-line implicit-arrow-linebreak\n  (Math.floor((275 * mon) / 9.0) + day + ((sec / 60.0 + minute) / 60.0 + hr) / 24.0) //  ut in days\n    .toFixed(5);\nexport const _pad0 = (str, max) => (str?.length < max ? _pad0('0' + str, max) : str);\n\nexport const omManager = om;\n","import { keepTrackApi } from '@app/js/api/keepTrackApi';\nimport { omManager } from '@app/js/plugins/initialOrbit/omManager.js';\nimport $ from 'jquery';\nimport iodPng from '@app/img/icons/iod.png';\nlet isObfitMenuOpen = false;\nexport const init = () => {\n    // Add HTML\n    keepTrackApi.register({\n        method: 'uiManagerInit',\n        cbName: 'initialOrbit',\n        cb: uiManagerInit,\n    });\n    // Add JavaScript\n    keepTrackApi.register({\n        method: 'bottomMenuClick',\n        cbName: 'initialOrbit',\n        cb: bottomMenuClick,\n    });\n    keepTrackApi.register({\n        method: 'hideSideMenus',\n        cbName: 'initialOrbit',\n        cb: hideSideMenus,\n    });\n};\nexport const hideSideMenus = () => {\n    $('#obfit-menu').effect('slide', { direction: 'left', mode: 'hide' }, 1000);\n    $('#menu-obfit').removeClass('bmenu-item-selected');\n    isObfitMenuOpen = false;\n};\nexport const uiManagerInit = () => {\n    // Side Menu\n    $('#left-menus').append(keepTrackApi.html `\n    <div id=\"obfit-menu\" class=\"side-menu-parent start-hidden text-select\">\n      <div id=\"obfit-content\" class=\"side-menu\">\n        <form id=\"obfit-form\">\n          <div class=\"switch row\">\n            <h5 class=\"center-align\">Initial Orbit Determination</h5>\n          </div>\n          <div class=\"switch row\">\n            <h6 class=\"center-align\">Observation 1</h5>\n            <div class=\"input-field col s12\">\n              <input value=\"1606439414717\" id=\"obfit-t1\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Time in Unix Time\">\n              <label for=\"obfit-t\" class=\"active\">Time</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <div class=\"input-field col s4\">\n              <input value=\"-3323.62939453125\" id=\"obfit-x1\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"X\">\n              <label for=\"obfit-lat\" class=\"active\">X</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"-4930.19384765625\" id=\"obfit-y1\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Y\">\n              <label for=\"obfit-lat\" class=\"active\">Y</label>\n            </div><div class=\"input-field col s4\">\n              <input value=\"-3303.053955078125\" id=\"obfit-z1\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Z\">\n              <label for=\"obfit-lat\" class=\"active\">Z</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <div class=\"input-field col s4\">\n              <input value=\"3.2059669494628906\" id=\"obfit-xd1\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n              data-delay=\"50\" data-tooltip=\"X Dot\">\n              <label for=\"obfit-lat\" class=\"active\">X Dot</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"-4.953164100646973\" id=\"obfit-yd1\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Y Dot\">\n              <label for=\"obfit-lat\" class=\"active\">Y Dot</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"4.8763322830200195\" id=\"obfit-zd1\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Z Dot\">\n              <label for=\"obfit-lat\" class=\"active\">Z Dot</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <h6 class=\"center-align\">Observation 2 (Optional)</h5>\n            <div class=\"input-field col s12\">\n              <input value=\"\" id=\"obfit-t2\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Time in Unix Time\">\n              <label for=\"obfit-t\" class=\"active\">Time</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-x2\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"X\">\n              <label for=\"obfit-lat\" class=\"active\">X</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-y2\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Y\">\n              <label for=\"obfit-lat\" class=\"active\">Y</label>\n            </div><div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-z2\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Z\">\n              <label for=\"obfit-lat\" class=\"active\">Z</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-xd2\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n              data-delay=\"50\" data-tooltip=\"X Dot\">\n              <label for=\"obfit-lat\" class=\"active\">X Dot</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-yd2\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Y Dot\">\n              <label for=\"obfit-lat\" class=\"active\">Y Dot</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-zd2\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Z Dot\">\n              <label for=\"obfit-lat\" class=\"active\">Z Dot</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <h6 class=\"center-align\">Observation 3 (Optional)</h5>\n            <div class=\"input-field col s12\">\n              <input value=\"\" id=\"obfit-t3\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Time in Unix Time\">\n              <label for=\"obfit-t\" class=\"active\">Time</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-x3\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"X\">\n              <label for=\"obfit-lat\" class=\"active\">X</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-y3\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Y\">\n              <label for=\"obfit-lat\" class=\"active\">Y</label>\n            </div><div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-z3\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Z\">\n              <label for=\"obfit-lat\" class=\"active\">Z</label>\n            </div>\n          </div>\n          <div class=\"switch row\">\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-xd3\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n              data-delay=\"50\" data-tooltip=\"X Dot\">\n              <label for=\"obfit-lat\" class=\"active\">X Dot</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-yd3\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Y Dot\">\n              <label for=\"obfit-lat\" class=\"active\">Y Dot</label>\n            </div>\n            <div class=\"input-field col s4\">\n              <input value=\"\" id=\"obfit-zd3\" type=\"text\" class=\"tooltipped\" data-position=\"right\"\n                data-delay=\"50\" data-tooltip=\"Z Dot\">\n              <label for=\"obfit-lat\" class=\"active\">Z Dot</label>\n            </div>\n          </div>\n          <div class=\"row center\">\n            <button id=\"obfit-submit\" class=\"btn btn-ui waves-effect waves-light\" type=\"submit\"\n              name=\"action\">Create Analyst Satellite &#9658;\n            </button>\n          </div>\n        </form>\n        <div class=\"row\">\n          <table id=\"obfit\" class=\"center-align striped-light centered\"></table>\n        </div>\n      </div>\n    </div>     \n  `);\n    // Bottom Icon\n    $('#bottom-icons').append(keepTrackApi.html `\n    <div id=\"menu-obfit\" class=\"bmenu-item\">\n      <img\n        alt=\"obfit\"\n        src=\"\"\n        delayedsrc=${iodPng}/>\n      <span class=\"bmenu-title\">Initial Orbit</span>\n      <div class=\"status-icon\"></div>\n    </div>\n  `);\n    $('#obfit-menu').resizable({\n        handles: 'e',\n        stop: function () {\n            $(this).css('height', '');\n        },\n        maxWidth: 650,\n        minWidth: 400,\n    });\n    $('#obfit-form').on('submit', function (e) {\n        obfitFormSubmit(e);\n    });\n};\nexport const bottomMenuClick = (iconName) => {\n    const { uiManager } = keepTrackApi.programs;\n    if (iconName === 'menu-obfit') {\n        if (isObfitMenuOpen) {\n            isObfitMenuOpen = false;\n            uiManager.hideSideMenus();\n            return;\n        }\n        else {\n            if (settingsManager.isMobileModeEnabled)\n                uiManager.searchToggle(false);\n            uiManager.hideSideMenus();\n            $('#obfit-menu').effect('slide', { direction: 'left', mode: 'show' }, 1000);\n            isObfitMenuOpen = true;\n            $('#menu-obfit').addClass('bmenu-item-selected');\n            return;\n        }\n    }\n};\nexport const obfitFormSubmit = (e) => {\n    const { uiManager, satSet, timeManager, satellite } = keepTrackApi.programs;\n    let t1v, x1v, y1v, z1v, xd1v, yd1v, zd1v;\n    let t2v, x2v, y2v, z2v, xd2v, yd2v, zd2v;\n    let t3v, x3v, y3v, z3v, xd3v, yd3v, zd3v;\n    let isOb2 = true;\n    let isOb3 = true;\n    const t1 = document.getElementById('obfit-t1').value;\n    if (t1.length > 0) {\n        t1v = parseFloat(t1);\n    }\n    else {\n        t1v = NaN;\n    }\n    const x1 = document.getElementById('obfit-x1').value;\n    if (x1.length > 0) {\n        x1v = parseFloat(x1);\n    }\n    else {\n        x1v = NaN;\n    }\n    const y1 = document.getElementById('obfit-y1').value;\n    if (y1.length > 0) {\n        y1v = parseFloat(y1);\n    }\n    else {\n        y1v = NaN;\n    }\n    const z1 = document.getElementById('obfit-z1').value;\n    if (z1.length > 0) {\n        z1v = parseFloat(z1);\n    }\n    else {\n        z1v = NaN;\n    }\n    const xd1 = document.getElementById('obfit-xd1').value;\n    if (xd1.length > 0) {\n        xd1v = parseFloat(xd1);\n    }\n    else {\n        xd1v = NaN;\n    }\n    const yd1 = document.getElementById('obfit-yd1').value;\n    if (yd1.length > 0) {\n        yd1v = parseFloat(yd1);\n    }\n    else {\n        yd1v = NaN;\n    }\n    const zd1 = document.getElementById('obfit-zd1').value;\n    if (zd1.length > 0) {\n        zd1v = parseFloat(zd1);\n    }\n    else {\n        zd1v = NaN;\n    }\n    const t2 = document.getElementById('obfit-t2').value;\n    if (t2.length > 0) {\n        t2v = parseFloat(t2);\n    }\n    else {\n        isOb2 = false;\n    }\n    const x2 = document.getElementById('obfit-x2').value;\n    if (x2.length > 0) {\n        x2v = parseFloat(x2);\n    }\n    else {\n        isOb2 = false;\n    }\n    const y2 = document.getElementById('obfit-y2').value;\n    if (y2.length > 0) {\n        y2v = parseFloat(y2);\n    }\n    else {\n        isOb2 = false;\n    }\n    const z2 = document.getElementById('obfit-z2').value;\n    if (z2.length > 0) {\n        z2v = parseFloat(z2);\n    }\n    else {\n        isOb2 = false;\n    }\n    const xd2 = document.getElementById('obfit-xd2').value;\n    if (xd2.length > 0) {\n        xd2v = parseFloat(xd2);\n    }\n    else {\n        isOb2 = false;\n    }\n    const yd2 = document.getElementById('obfit-yd2').value;\n    if (yd2.length > 0) {\n        yd2v = parseFloat(yd2);\n    }\n    else {\n        isOb2 = false;\n    }\n    const zd2 = document.getElementById('obfit-zd2').value;\n    if (zd2.length > 0) {\n        zd2v = parseFloat(zd2);\n    }\n    else {\n        isOb2 = false;\n    }\n    const t3 = document.getElementById('obfit-t3').value;\n    if (t3.length > 0) {\n        t3v = parseFloat(t3);\n    }\n    else {\n        isOb3 = false;\n    }\n    const x3 = document.getElementById('obfit-x3').value;\n    if (x3.length > 0) {\n        x3v = parseFloat(x3);\n    }\n    else {\n        isOb3 = false;\n    }\n    const y3 = document.getElementById('obfit-y3').value;\n    if (y3.length > 0) {\n        y3v = parseFloat(y3);\n    }\n    else {\n        isOb3 = false;\n    }\n    const z3 = document.getElementById('obfit-z3').value;\n    if (z3.length > 0) {\n        z3v = parseFloat(z3);\n    }\n    else {\n        isOb3 = false;\n    }\n    const xd3 = document.getElementById('obfit-xd3').value;\n    if (xd3.length > 0) {\n        xd3v = parseFloat(xd3);\n    }\n    else {\n        isOb3 = false;\n    }\n    const yd3 = document.getElementById('obfit-yd3').value;\n    if (yd3.length > 0) {\n        yd3v = parseFloat(yd3);\n    }\n    else {\n        isOb3 = false;\n    }\n    const zd3 = document.getElementById('obfit-zd3').value;\n    if (zd3.length > 0) {\n        zd3v = parseFloat(zd3);\n    }\n    else {\n        isOb3 = false;\n    }\n    const svs = [];\n    let sv1 = [];\n    {\n        if (isNaN(parseFloat(t1))) {\n            uiManager.toast(`Time 1 is Invalid!`, 'critical');\n            return false;\n        }\n        if (isNaN(parseFloat(x1))) {\n            uiManager.toast(`X 1 is Invalid!`, 'critical');\n            return false;\n        }\n        if (isNaN(parseFloat(y1))) {\n            uiManager.toast(`Y 1 is Invalid!`, 'critical');\n            return false;\n        }\n        if (isNaN(parseFloat(z1))) {\n            uiManager.toast(`Z 1 is Invalid!`, 'critical');\n            return false;\n        }\n        if (isNaN(parseFloat(xd1))) {\n            uiManager.toast(`X Dot 1 is Invalid!`, 'critical');\n            return false;\n        }\n        if (isNaN(parseFloat(yd1))) {\n            uiManager.toast(`Y Dot 1 is Invalid!`, 'critical');\n            return false;\n        }\n        if (isNaN(parseFloat(zd1))) {\n            uiManager.toast(`Z Dot 1 is Invalid!`, 'critical');\n            return false;\n        }\n        sv1 = [t1v, x1v, y1v, z1v, xd1v, yd1v, zd1v];\n        svs.push(sv1);\n    }\n    let sv2 = [];\n    {\n        if (isOb2 && isNaN(parseFloat(t2))) {\n            isOb2 = false;\n            uiManager.toast(`Time 2 is Invalid!`, 'caution');\n        }\n        if (isOb2 && isNaN(parseFloat(x2))) {\n            isOb2 = false;\n            uiManager.toast(`X 2 is Invalid!`, 'caution');\n        }\n        if (isOb2 && isNaN(parseFloat(y2))) {\n            isOb2 = false;\n            uiManager.toast(`Y 2 is Invalid!`, 'caution');\n        }\n        if (isOb2 && isNaN(parseFloat(z2))) {\n            isOb2 = false;\n            uiManager.toast(`Z 2 is Invalid!`, 'caution');\n        }\n        if (isOb2 && isNaN(parseFloat(xd2))) {\n            isOb2 = false;\n            uiManager.toast(`X Dot 2 is Invalid!`, 'caution');\n        }\n        if (isOb2 && isNaN(parseFloat(yd2))) {\n            isOb2 = false;\n            uiManager.toast(`Y Dot 2 is Invalid!`, 'caution');\n        }\n        if (isOb2 && isNaN(parseFloat(zd2))) {\n            isOb2 = false;\n            uiManager.toast(`Z Dot 2 is Invalid!`, 'caution');\n        }\n        if (isOb2) {\n            sv2 = [t2v, x2v, y2v, z2v, xd2v, yd2v, zd2v];\n            svs.push(sv2);\n        }\n    }\n    isOb3 = !isOb2 ? false : isOb3;\n    let sv3 = [];\n    {\n        if (isOb3 && isNaN(parseFloat(t3))) {\n            isOb3 = false;\n            uiManager.toast(`Time 3 is Invalid!`, 'caution');\n        }\n        if (isOb3 && isNaN(parseFloat(x3))) {\n            isOb3 = false;\n            uiManager.toast(`X 3 is Invalid!`, 'caution');\n        }\n        if (isOb3 && isNaN(parseFloat(y3))) {\n            isOb3 = false;\n            uiManager.toast(`Y 3 is Invalid!`, 'caution');\n        }\n        if (isOb3 && isNaN(parseFloat(z3))) {\n            isOb3 = false;\n            uiManager.toast(`Z 3 is Invalid!`, 'caution');\n        }\n        if (isOb3 && isNaN(parseFloat(xd3))) {\n            isOb3 = false;\n            uiManager.toast(`X Dot 3 is Invalid!`, 'caution');\n        }\n        if (isOb3 && isNaN(parseFloat(yd3))) {\n            isOb3 = false;\n            uiManager.toast(`Y Dot 3 is Invalid!`, 'caution');\n        }\n        if (isOb3 && isNaN(parseFloat(zd3))) {\n            isOb3 = false;\n            uiManager.toast(`Z Dot 3 is Invalid!`, 'caution');\n        }\n        if (isOb3) {\n            sv3 = [t3v, x3v, y3v, z3v, xd3v, yd3v, zd3v];\n            svs.push(sv3);\n        }\n    }\n    console.log(svs);\n    omManager.svs2analyst(svs, satSet, timeManager, satellite);\n    e.preventDefault();\n    return true;\n};\n"],"names":["searchBox","RADIUS_OF_EARTH","G","MILLISECONDS_PER_DAY","MINUTES_PER_DAY","PI","Math","TAU","RAD2DEG","om","sat2sv","sat","timeManager","calculateSimulationTime","position","x","y","z","velocity","sat2kp","sv","sv2kp","sat2tle","kp","kp2tle","kepler","_sv2kp","epoch","inc","inclination","raan","ecc","eccentricity","argpe","argPe","meana","mo","meanmo","period","Date","yy","getUTCFullYear","epochd","_dayOfYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","tle1","_pad0","parseFloat","toFixed","tle2","toPrecision","substr","svs2kps","svs","kpList","i","length","push","r","max","apogee","perigee","semiMajorAxis","ta","tl","min","avg","iod","satellite","kps","sort","a","b","value","fitTles","e","console","debug","closestApproach","STEPS","settingsManager","fitTleSteps","raanI","argpeI","meanaI","bestIndicies","m","possibleKp","tles","xError","yError","zError","posErrorAvg","svI","eci","_propagate","abs","sqrt","error","log","svs2analyst","satSet","then","insertNewAnalystSatellite","getIdFromObjNum","doSearch","catch","testIod","fetch","response","json","metObs","satrec","twoline2satrec","j","_jday","jdsatepoch","sgp4","year","mon","day","hr","minute","sec","floor","massPrimary","massSecondary","vector","massPrimaryU","massSecondaryU","vectorU","outputU","outputU2","rx","ry","rz","vx","vy","vz","mu","v","hx","hy","hz","h","p","q","ex","ey","acos","lan","_arctan2","tax","tay","cw","cos","sin","sw","w","u","PlusMinus","periapsis","apoapsis","atan","str","omManager"],"sourceRoot":""}