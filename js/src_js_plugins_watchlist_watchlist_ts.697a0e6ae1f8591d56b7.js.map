{"version":3,"file":"src_js_plugins_watchlist_watchlist_ts.697a0e6ae1f8591d56b7.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACwD;AACQ;AACnB;AACD;AACN;AACkB;AACV;AACvB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,IAAI,6CAAC,sCAAsC,iCAAiC;AAC5E,IAAI,6CAAC,yCAAyC,iCAAiC;AAC/E,IAAI,6CAAC;AACL,IAAI,6CAAC;AACL;AACA;AACA;AACO;AACP,YAAY,gDAAgD,EAAE,2EAAqB;AACnF,IAAI,qFAA+B;AACnC,IAAI,2GAAqD;AACzD;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,qGAA+C;AACnD;AACA;AACA;AACA;AACA,gBAAgB,aAAa,EAAE,2EAAqB;AACpD;AACA;AACA,oCAAoC,2GAAqD;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4BAA4B;AACxD;AACA;AACA;AACA;AACA,YAAY,2GAAqD;AACjE;AACA;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACO;AACP;AACA,YAAY,oBAAoB,EAAE,2EAAqB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;AACA;AACA,IAAI,6CAAC;AACL,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE;AACrE;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,IAAI,6CAAC,uBAAuB,uEAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gDAAS,CAAC;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,6CAAM,CAAC;AACzC;AACA;AACA;AACA,+HAA+H;AAC/H;AACA;AACA,+HAA+H;AAC/H,qFAAqF;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC,yBAAyB,uEAAiB;AAC/C;AACA;AACA;AACA,0BAA0B,yDAAY,CAAC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oDAAO,CAAC;AAClC;AACA;AACA;AACA;AACA,IAAI,6CAAC;AACL;AACA;AACA,YAAY,6CAAC;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL,IAAI,6CAAC;AACL,IAAI,6CAAC;AACL;AACA,KAAK;AACL,IAAI,6CAAC;AACL,sBAAsB,6CAAC;AACvB;AACA,KAAK;AACL;AACA,IAAI,6CAAC;AACL;AACA,IAAI,6CAAC;AACL;AACA,KAAK;AACL,IAAI,6CAAC;AACL;AACA,KAAK;AACL,IAAI,6CAAC;AACL,QAAQ,6CAAC;AACT,KAAK;AACL,IAAI,6CAAC;AACL;AACA,KAAK;AACL;AACO;AACP,YAAY,0EAA0E,EAAE,2EAAqB;AAC7G;AACA;AACA;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA,4BAA4B,4CAA4C;AACxE,6EAA6E;AAC7E;AACA;AACA;AACA;AACA;AACA,gBAAgB,8FAAwC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,YAAY;AACzD,gBAAgB,8FAAwC;AACxD;AACA;AACA;AACA;AACA;AACA,6CAA6C,YAAY;AACzD;AACA;AACA;AACA;AACA,oBAAoB,gCAAgC;AACpD;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,2DAA2D,EAAE,2EAAqB;AAC9F;AACA;AACA;AACA;AACA,iBAAiB,6CAAC;AAClB,gBAAgB,6CAAC;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,6CAAC;AACtB,oBAAoB,6CAAC;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,6CAAC;AACjB;AACA,oCAAoC,0BAA0B;AAC9D;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,oBAAoB,2GAAqD;AACzE;AACA,oBAAoB,6CAAC;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,YAAY,6CAAC,yCAAyC,iCAAiC;AACvF,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,6CAAC,sCAAsC,iCAAiC;AACpF;AACA;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACO;AACP,YAAY,wBAAwB,EAAE,2EAAqB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iDAAK,IAAI,iCAAiC;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,yBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA,CAAC;AACM;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,wBAAwB,EAAE,2EAAqB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,qEAAqE,EAAE,2EAAqB;AACxG,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6CAAC;AACT;AACA;AACO;AACP,YAAY,wBAAwB,EAAE,2EAAqB;AAC3D,iFAAiF,6CAAC;AAClF;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6CAAC;AACT;AACA,IAAI,6CAAC,4BAA4B;AACjC;AACA;AACA;AACO;AACP,YAAY,SAAS,EAAE,2EAAqB;AAC5C;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,KAAK;AACL;AACA,QAAQ,2DAAM;AACd;AACA;AACA,QAAQ,2FAAqC;AAC7C;AACA;AACA;AACO;AACP;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,mCAAmC,EAAE,2EAAqB;AACtE;AACA;AACA;AACA,QAAQ,2FAAqC;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6CAAC;AACT;AACA;AACO;AACP;AACA,QAAQ,6CAAC;AACT;AACA","sources":["webpack://keeptrack.space/./src/js/plugins/watchlist/watchlist.ts"],"sourcesContent":["/**\n * /////////////////////////////////////////////////////////////////////////////\n *\n * watchlist.ts is a plugin for creating a list of satellites to actively monitor\n *\n * http://keeptrack.space\n *\n * @Copyright (C) 2016-2022 Theodore Kruczek\n *\n * KeepTrack is free software: you can redistribute it and/or modify it under\n * the terms of the GNU General Public License as published by the Free Software\n * Foundation, either version 3 of the License, or (at your option) any later version.\n *\n * KeepTrack is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.\n * You should have received a copy of the GNU General Public License along with\n * KeepTrack. If not, see <http://www.gnu.org/licenses/>.\n *\n * TESTING: This plugin requires php to be installed on the server. It won't work\n * with the default http npm module.\n *\n * /////////////////////////////////////////////////////////////////////////////\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { keepTrackApi } from '@app/js/api/keepTrackApi';\nimport { dateFormat } from '@app/js/lib/external/dateFormat.js';\nimport { saveAs } from '@app/js/lib/helpers';\nimport removePng from '@app/img/remove.png';\nimport addPng from '@app/img/add.png';\nimport watchlistPng from '@app/img/icons/watchlist.png';\nimport infoPng from '@app/img/icons/info.png';\nimport $ from 'jquery';\nlet watchlistList = [];\nlet watchlistInViewList = [];\nlet isWatchlistChanged = null;\nlet isWatchlistMenuOpen = false;\nlet nextPassEarliestTime;\nlet nextPassArray = [];\nlet isInfoOverlayMenuOpen = false;\nexport const hideSideMenus = () => {\n    $('#watchlist-menu').effect('slide', { direction: 'left', mode: 'hide' }, 1000);\n    $('#info-overlay-menu').effect('slide', { direction: 'left', mode: 'hide' }, 1000);\n    $('#menu-info-overlay').removeClass('bmenu-item-selected');\n    $('#menu-watchlist').removeClass('bmenu-item-selected');\n    isInfoOverlayMenuOpen = false;\n    isWatchlistMenuOpen = false;\n};\nexport const init = () => {\n    const { satSet, objectManager, uiManager, timeManager } = keepTrackApi.programs;\n    keepTrackApi.programs.watchlist = {};\n    keepTrackApi.programs.watchlist.lastOverlayUpdateTime = 0;\n    // Add HTML\n    keepTrackApi.register({\n        method: 'uiManagerInit',\n        cbName: 'watchlist',\n        cb: uiManagerInit,\n    });\n    keepTrackApi.programs.watchlist.updateWatchlist = updateWatchlist;\n    let infoOverlayDOM = [];\n    uiManager.updateNextPassOverlay = (nextPassArrayIn, isForceUpdate) => {\n        if (nextPassArrayIn.length <= 0 && !isInfoOverlayMenuOpen)\n            return;\n        const { mainCamera } = keepTrackApi.programs;\n        // TODO: This should auto update the overlay when the time changes outside the original search window\n        // Update once every 10 seconds\n        if ((timeManager.realTime > keepTrackApi.programs.watchlist.lastOverlayUpdateTime * 1 + 10000 &&\n            objectManager.selectedSat === -1 &&\n            !mainCamera.isDragging &&\n            mainCamera.zoomLevel === mainCamera.zoomTarget) ||\n            isForceUpdate) {\n            const propTime = timeManager.calculateSimulationTime();\n            infoOverlayDOM = [];\n            infoOverlayDOM.push('<div>');\n            for (let s = 0; s < nextPassArrayIn.length; s++) {\n                pushOverlayElement(satSet, nextPassArrayIn, s, propTime, infoOverlayDOM);\n            }\n            infoOverlayDOM.push('</div>');\n            document.getElementById('info-overlay-content').innerHTML = infoOverlayDOM.join('');\n            keepTrackApi.programs.watchlist.lastOverlayUpdateTime = timeManager.realTime;\n        }\n    };\n    keepTrackApi.register({\n        method: 'updateLoop',\n        cbName: 'watchlist',\n        cb: updateLoop,\n    });\n    // Add JavaScript\n    keepTrackApi.register({\n        method: 'bottomMenuClick',\n        cbName: 'watchlist',\n        cb: (iconName) => bottomMenuClick(iconName),\n    });\n    keepTrackApi.register({\n        method: 'onCruncherReady',\n        cbName: 'watchlist',\n        cb: onCruncherReady,\n    });\n    keepTrackApi.register({\n        method: 'hideSideMenus',\n        cbName: 'watchlist',\n        cb: hideSideMenus,\n    });\n};\nexport const updateWatchlist = (updateWatchlistList, updateWatchlistInViewList, isSkipSearch = false) => {\n    const settingsManager = window.settingsManager;\n    const { satSet, uiManager } = keepTrackApi.programs;\n    if (typeof updateWatchlistList !== 'undefined') {\n        watchlistList = updateWatchlistList;\n    }\n    if (typeof updateWatchlistInViewList !== 'undefined') {\n        watchlistInViewList = updateWatchlistInViewList;\n    }\n    if (!watchlistList)\n        return;\n    settingsManager.isThemesNeeded = true;\n    isWatchlistChanged = isWatchlistChanged != null;\n    let watchlistString = '';\n    let watchlistListHTML = '';\n    let sat;\n    for (let i = 0; i < watchlistList.length; i++) {\n        sat = satSet.getSatExtraOnly(watchlistList[i]);\n        if (sat == null) {\n            watchlistList.splice(i, 1);\n        }\n        else {\n            watchlistListHTML += `\n      <div class=\"row\">\n        <div class=\"col s3 m3 l3\">\n          ${sat.sccNum}\n        </div>\n        <div class=\"col s7 m7 l7\">\n          ${sat.name || 'Unknown'}\n        </div>\n        <div class=\"col s2 m2 l2 center-align remove-icon\">\n          <img class=\"watchlist-remove\" data-sat-id=\"${sat.id}\" src=\"img/remove.png\"></img>\n        </div>\n      </div>`;\n        }\n    }\n    $('#watchlist-list').html(watchlistListHTML);\n    for (let i = 0; i < watchlistList.length; i++) {\n        // No duplicates\n        watchlistString += satSet.getSatExtraOnly(watchlistList[i]).sccNum;\n        if (i !== watchlistList.length - 1)\n            watchlistString += ',';\n    }\n    if (!isSkipSearch)\n        uiManager.doSearch(watchlistString, true);\n    satSet.setColorScheme(settingsManager.currentColorScheme, true); // force color recalc\n    const saveWatchlist = [];\n    for (let i = 0; i < watchlistList.length; i++) {\n        sat = satSet.getSatExtraOnly(watchlistList[i]);\n        saveWatchlist[i] = sat.sccNum;\n    }\n    const variable = JSON.stringify(saveWatchlist);\n    try {\n        localStorage.setItem('watchlistList', variable);\n    }\n    catch (_a) {\n        // DEBUG:\n        // console.warn('Watchlist Plugin: Unable to save watchlist - localStorage issue!');\n    }\n};\nexport const uiManagerInit = () => {\n    // Side Menu\n    $('#left-menus').append(keepTrackApi.html `\n  <div id=\"watchlist-menu\" class=\"side-menu-parent start-hidden text-select\">\n    <div id=\"watchlist-content\" class=\"side-menu\">\n      <div class=\"row\">\n        <h5 class=\"center-align\">Satellite Watchlist</h5>\n        <div id=\"watchlist-list\">\n          <div class=\"row\">\n            <div class=\"col s3 m3 l3\">25544</div>\n            <div class=\"col s7 m7 l7\">ISS (ZARYA)</div>\n            <div class=\"col s2 m2 l2 center-align remove-icon\">\n              <img\n                alt=\"remove\"\n                src=\"\" delayedsrc=${removePng}/>\n            </div>\n          </div>\n        </div>\n        <br />\n        <div class=\"row\">\n          <div class=\"input-field col s10 m10 l10\">\n            <form id=\"watchlist-submit\">\n              <input placeholder=\"xxxxx\" id=\"watchlist-new\" type=\"text\" />\n              <label for=\"watchlist-new\">New Satellite</label>\n            </form>\n          </div>\n          <div class=\"col s2 m2 l2 center-align add-icon\">\n            <img\n              class=\"watchlist-add\"\n              src=\"\" delayedsrc=${addPng}/>\n          </div>\n        </div>\n        <div class=\"center-align row\">\n          <button id=\"watchlist-save\" class=\"btn btn-ui waves-effect waves-light\" type=\"button\" name=\"action\">Save List &#9658;</button>\n        </div>\n        <div class=\"center-align row\">\n          <button id=\"watchlist-open\" class=\"btn btn-ui waves-effect waves-light\" type=\"button\" name=\"action\">Load List &#9658;</button>\n          <input id=\"watchlist-file\" type=\"file\" name=\"files[]\" style=\"display: none;\" />\n        </div>\n      </div>\n    </div>\n  </div>\n  <div id=\"info-overlay-menu\" class=\"start-hidden text-select\">\n    <div id=\"info-overlay-content\"></div>\n  </div>\n`);\n    // Bottom Icon\n    $('#bottom-icons').append(keepTrackApi.html `  \n  <div id=\"menu-watchlist\" class=\"bmenu-item\">\n    <img\n      alt=\"watchlist\"\n      src=\"\" delayedsrc=${watchlistPng}/>\n    <span class=\"bmenu-title\">Watchlist</span>\n    <div class=\"status-icon\"></div>\n  </div>    \n  <div id=\"menu-info-overlay\" class=\"bmenu-item bmenu-item-disabled\">\n    <img\n      alt=\"info\"\n      src=\"\" delayedsrc=${infoPng}/>\n    <span class=\"bmenu-title\">Overlay</span>\n    <div class=\"status-icon\"></div>\n  </div>\n`);\n    $('#watchlist-menu').resizable({\n        handles: 'e',\n        stop: function () {\n            $(this).css('height', '');\n        },\n        maxWidth: 450,\n        minWidth: 280,\n    });\n    $('.menu-selectable').on('click', menuSelectableClick);\n    $('#info-overlay-content').on('click', '.watchlist-object', function (evt) {\n        infoOverlayContentClick(evt);\n    });\n    $('#watchlist-list').on('click', '.watchlist-remove', function () {\n        const satId = $(this).data('sat-id');\n        watchlistListClick(satId);\n    });\n    // Add button selected on watchlist menu\n    $('#watchlist-content').on('click', '.watchlist-add', watchlistContentEvent);\n    // Enter pressed/selected on watchlist menu\n    $('#watchlist-content').on('submit', function (evt) {\n        watchlistContentEvent(evt);\n    });\n    $('#watchlist-save').on('click', function (evt) {\n        watchlistSaveClick(evt);\n    });\n    $('#watchlist-open').on('click', function () {\n        $('#watchlist-file').trigger('click');\n    });\n    $('#watchlist-file').on('change', function (evt) {\n        watchlistFileChange(evt);\n    });\n};\nexport const updateLoop = () => {\n    const { satellite, satSet, orbitManager, uiManager, sensorManager, timeManager, } = keepTrackApi.programs;\n    uiManager.updateNextPassOverlay(nextPassArray);\n    if (watchlistList.length <= 0)\n        return;\n    for (let i = 0; i < watchlistList.length; i++) {\n        const sat = satSet.getSat(watchlistList[i]);\n        if (sensorManager.currentSensorMultiSensor) {\n            orbitManager.removeInViewOrbit(watchlistList[i]);\n            for (let j = 0; j < sensorManager.currentSensorList.length; j++) {\n                const satrec = satellite.twoline2satrec(sat.TLE1, sat.TLE2); // perform and store sat init calcs\n                const sensor = sensorManager.currentSensorList[j];\n                const rae = satellite.getRae(timeManager.dateObject, satrec, sensor);\n                const isInFov = satellite.checkIsInView(sensor, rae);\n                if (!isInFov)\n                    continue;\n                keepTrackApi.programs.lineManager.create('sat3', [sat.id, satSet.getSensorFromSensorName(sensor.name)], 'g');\n            }\n        }\n        else {\n            if (sat.inView === 1 && watchlistInViewList[i] === false) {\n                // Is inview and wasn't previously\n                watchlistInViewList[i] = true;\n                uiManager.toast(`Satellite ${sat.sccNum} is In Field of View!`, 'normal');\n                keepTrackApi.programs.lineManager.create('sat3', [sat.id, satSet.getSensorFromSensorName(sensorManager.currentSensor[0].name)], 'g');\n                orbitManager.addInViewOrbit(watchlistList[i]);\n            }\n            if (sat.inView === 0 && watchlistInViewList[i] === true) {\n                // Isn't inview and was previously\n                watchlistInViewList[i] = false;\n                uiManager.toast(`Satellite ${sat.sccNum} left Field of View!`, 'standby');\n                orbitManager.removeInViewOrbit(watchlistList[i]);\n            }\n        }\n    }\n    for (let i = 0; i < watchlistInViewList.length; i++) {\n        if (watchlistInViewList[i] === true) {\n            return;\n        }\n    }\n};\nexport const bottomMenuClick = (iconName) => {\n    const { satellite, satSet, uiManager, sensorManager, timeManager } = keepTrackApi.programs;\n    if (iconName === 'menu-info-overlay') {\n        if (!sensorManager.checkSensorSelected()) {\n            // No Sensor Selected\n            uiManager.toast(`Select a Sensor First!`, 'caution', true);\n            if (!$('#menu-info-overlay:animated').length) {\n                $('#menu-info-overlay').effect('shake', {\n                    distance: 10,\n                });\n            }\n            return;\n        }\n        if (isInfoOverlayMenuOpen) {\n            isInfoOverlayMenuOpen = false;\n            uiManager.hideSideMenus();\n            return;\n        }\n        else {\n            if (watchlistList.length === 0 && !isWatchlistChanged) {\n                uiManager.toast(`Add Satellites to Watchlist!`, 'caution');\n                if (!$('#menu-info-overlay:animated').length) {\n                    $('#menu-info-overlay').effect('shake', {\n                        distance: 10,\n                    });\n                }\n                nextPassArray = [];\n                return;\n            }\n            uiManager.hideSideMenus();\n            if (nextPassArray.length === 0 ||\n                nextPassEarliestTime > timeManager.realTime ||\n                new Date(nextPassEarliestTime * 1 + 1000 * 60 * 60 * 24) < timeManager.realTime ||\n                isWatchlistChanged) {\n                $('#loading-screen').fadeIn(1000, function () {\n                    nextPassArray = [];\n                    for (let x = 0; x < watchlistList.length; x++) {\n                        nextPassArray.push(satSet.getSatExtraOnly(watchlistList[x]));\n                    }\n                    nextPassArray = satellite.nextpassList(nextPassArray);\n                    nextPassArray.sort(function (a, b) {\n                        return new Date(a.time).getTime() - new Date(b.time).getTime();\n                    });\n                    nextPassEarliestTime = timeManager.realTime;\n                    keepTrackApi.programs.watchlist.lastOverlayUpdateTime = 0;\n                    uiManager.updateNextPassOverlay(nextPassArray, true);\n                    $('#loading-screen').fadeOut('slow');\n                    isWatchlistChanged = false;\n                });\n            }\n            else {\n                uiManager.updateNextPassOverlay(nextPassArray, true);\n            }\n            $('#info-overlay-menu').effect('slide', { direction: 'left', mode: 'show' }, 1000);\n            $('#menu-info-overlay').addClass('bmenu-item-selected');\n            isInfoOverlayMenuOpen = true;\n            return;\n        }\n    }\n    if (iconName === 'menu-watchlist') {\n        if (isWatchlistMenuOpen) {\n            isWatchlistMenuOpen = false;\n            $('#menu-watchlist').removeClass('bmenu-item-selected');\n            uiManager.hideSideMenus();\n            return;\n        }\n        else {\n            if (settingsManager.isMobileModeEnabled)\n                uiManager.searchToggle(false);\n            uiManager.hideSideMenus();\n            $('#watchlist-menu').effect('slide', { direction: 'left', mode: 'show' }, 1000);\n            updateWatchlist();\n            isWatchlistMenuOpen = true;\n            $('#menu-watchlist').addClass('bmenu-item-selected');\n            return;\n        }\n    }\n};\nexport const onCruncherReady = () => __awaiter(void 0, void 0, void 0, function* () {\n    const { satSet, sensorManager } = keepTrackApi.programs;\n    let watchlistJSON;\n    try {\n        watchlistJSON = localStorage.getItem('watchlistList');\n    }\n    catch (_a) {\n        watchlistJSON = null;\n    }\n    if (watchlistJSON === null || watchlistJSON === '[]') {\n        try {\n            watchlistJSON = yield $.get(`${settingsManager.installDirectory}tle/watchlist.json`);\n        }\n        catch (_b) {\n            watchlistJSON = null;\n        }\n    }\n    if (watchlistJSON !== null && watchlistJSON !== '[]' && watchlistJSON.length > 0) {\n        const newWatchlist = JSON.parse(watchlistJSON);\n        const _watchlistInViewList = [];\n        for (let i = 0; i < newWatchlist.length; i++) {\n            const sat = satSet.getSatExtraOnly(satSet.getIdFromObjNum(newWatchlist[i]));\n            if (sat !== null) {\n                newWatchlist[i] = sat.id;\n                _watchlistInViewList.push(false);\n            }\n            else {\n                // DEBUG:\n                // console.debug('Watchlist File Format Incorret');\n                return;\n            }\n        }\n        if (sensorManager.checkSensorSelected() && newWatchlist.length > 0) {\n            $('#menu-info-overlay').removeClass('bmenu-item-disabled');\n        }\n        updateWatchlist(newWatchlist, _watchlistInViewList, true);\n    }\n});\nexport const pushOverlayElement = (satSet, nextPassArrayIn, s, propTime, infoOverlayDOM) => {\n    if (typeof (satSet === null || satSet === void 0 ? void 0 : satSet.getSatInViewOnly) !== 'function')\n        throw new Error('satSet is not proper satSet Object');\n    const satInView = satSet.getSatInViewOnly(satSet.getIdFromObjNum(nextPassArrayIn[s].sccNum)).inView;\n    // If old time and not in view, skip it\n    if (nextPassArrayIn[s].time - propTime < -1000 * 60 * 5 && !satInView)\n        return;\n    // Get the pass Time\n    const time = dateFormat(nextPassArrayIn[s].time, 'isoTime', true);\n    // Yellow - In View and Time to Next Pass is +/- 30 minutes\n    if (satInView && nextPassArrayIn[s].time - propTime < 1000 * 60 * 30 && propTime - nextPassArrayIn[s].time < 1000 * 60 * 30) {\n        infoOverlayDOM.push('<div class=\"row\"><h5 class=\"center-align watchlist-object link\" style=\"color: yellow\">' + nextPassArrayIn[s].sccNum + ': ' + time + '</h5></div>');\n        return;\n    }\n    // Blue - Time to Next Pass is between 10 minutes before and 20 minutes after the current time\n    // This makes recent objects stay at the top of the list in blue\n    if (nextPassArrayIn[s].time - propTime < 1000 * 60 * 10 && propTime - nextPassArrayIn[s].time < 1000 * 60 * 20) {\n        infoOverlayDOM.push('<div class=\"row\"><h5 class=\"center-align watchlist-object link\" style=\"color: blue\">' + nextPassArrayIn[s].sccNum + ': ' + time + '</h5></div>');\n        return;\n    }\n    // White - Any future pass not fitting the above requirements\n    if (nextPassArrayIn[s].time - propTime > 0) {\n        infoOverlayDOM.push('<div class=\"row\"><h5 class=\"center-align watchlist-object link\" style=\"color: white\">' + nextPassArrayIn[s].sccNum + ': ' + time + '</h5></div>');\n    }\n};\nexport const infoOverlayContentClick = (evt) => {\n    const { satSet, objectManager } = keepTrackApi.programs;\n    let objNum = evt.currentTarget.textContent.split(':');\n    objNum = objNum[0];\n    const satId = satSet.getIdFromObjNum(objNum);\n    if (satId !== null) {\n        objectManager.setSelectedSat(satId);\n    }\n};\nexport const watchlistListClick = (satId) => {\n    const { orbitManager, uiManager, satSet, colorSchemeManager, sensorManager } = keepTrackApi.programs;\n    for (let i = 0; i < watchlistList.length; i++) {\n        if (watchlistList[i] === satId) {\n            orbitManager.removeInViewOrbit(watchlistList[i]);\n            watchlistList.splice(i, 1);\n            watchlistInViewList.splice(i, 1);\n        }\n    }\n    updateWatchlist();\n    if (watchlistList.length <= 0) {\n        uiManager.doSearch('');\n        satSet.setColorScheme(colorSchemeManager.default, true);\n        uiManager.colorSchemeChangeAlert(settingsManager.currentColorScheme);\n    }\n    if (!sensorManager.checkSensorSelected() || watchlistList.length <= 0) {\n        isWatchlistChanged = false;\n        $('#menu-info-overlay').addClass('bmenu-item-disabled');\n    }\n};\nexport const watchlistContentEvent = (e, satId) => {\n    const { satSet, sensorManager } = keepTrackApi.programs;\n    satId !== null && satId !== void 0 ? satId : (satId = satSet.getIdFromObjNum($('#watchlist-new').val()));\n    let duplicate = false;\n    for (let i = 0; i < watchlistList.length; i++) {\n        // No duplicates\n        if (watchlistList[i] === satId)\n            duplicate = true;\n    }\n    if (!duplicate) {\n        watchlistList.push(satId);\n        watchlistInViewList.push(false);\n        updateWatchlist();\n    }\n    if (sensorManager.checkSensorSelected()) {\n        $('#menu-info-overlay').removeClass('bmenu-item-disabled');\n    }\n    $('#watchlist-new').val(''); // Clear the search box after enter pressed/selected\n    if (typeof e !== 'undefined' && e !== null)\n        e.preventDefault();\n};\nexport const watchlistSaveClick = (evt) => {\n    const { satSet } = keepTrackApi.programs;\n    const saveWatchlist = [];\n    for (let i = 0; i < watchlistList.length; i++) {\n        const sat = satSet.getSatExtraOnly(watchlistList[i]);\n        saveWatchlist[i] = sat.sccNum;\n    }\n    const variable = JSON.stringify(saveWatchlist);\n    const blob = new Blob([variable], {\n        type: 'text/plain;charset=utf-8',\n    });\n    try {\n        saveAs(blob, 'watchlist.json');\n    }\n    catch (e) {\n        keepTrackApi.programs.uiManager.toast('Error saving watchlist', 'critical');\n    }\n    evt.preventDefault();\n};\nexport const watchlistFileChange = (evt) => {\n    if (evt === null)\n        throw new Error('evt is null');\n    if (!window.FileReader)\n        return; // Browser is not compatible\n    const reader = new FileReader();\n    reader.onload = function (e) {\n        watchListReaderOnLoad(e);\n    };\n    reader.readAsText(evt.target.files[0]);\n    evt.preventDefault();\n};\nexport const watchListReaderOnLoad = (evt) => {\n    const { satSet, uiManager, sensorManager } = keepTrackApi.programs;\n    if (evt.target.readyState !== 2)\n        return;\n    if (evt.target.error) {\n        keepTrackApi.programs.uiManager.toast('Error reading watchlist', 'critical');\n        return;\n    }\n    let newWatchlist;\n    try {\n        newWatchlist = JSON.parse(evt.target.result);\n    }\n    catch (_a) {\n        uiManager.toast('Watchlist file format incorrect!', 'critical');\n        return;\n    }\n    if (newWatchlist.length === 0) {\n        uiManager.toast('Watchlist file format incorrect!', 'critical');\n        return;\n    }\n    watchlistInViewList = [];\n    for (let i = 0; i < newWatchlist.length; i++) {\n        const sat = satSet.getSatExtraOnly(satSet.getIdFromObjNum(newWatchlist[i]));\n        if (sat !== null && sat.id > 0) {\n            newWatchlist[i] = sat.id;\n            watchlistInViewList.push(false);\n        }\n        else {\n            uiManager.toast('Sat ' + newWatchlist[i] + ' not found!', 'caution');\n            continue;\n        }\n    }\n    watchlistList = newWatchlist;\n    updateWatchlist();\n    if (sensorManager.checkSensorSelected()) {\n        $('#menu-info-overlay').removeClass('bmenu-item-disabled');\n    }\n};\nexport const menuSelectableClick = () => {\n    if (watchlistList.length > 0) {\n        $('#menu-info-overlay').removeClass('bmenu-item-disabled');\n    }\n};\n"],"names":[],"sourceRoot":""}