{"version":3,"file":"src_js_plugins_nextLaunch_nextLaunch_ts.557fed2226fbb6af3f0d.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAwD;AACQ;AACF;AACvC;AACvB;AACA;AACA;AACA,aAAa,4BAA4B;AACzC;AACO;AACP,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,2DAA2D,aAAa;AACxE;AACA;AACA,2DAA2D,aAAa;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8EAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,mEAAc,eAAe;AACvD;AACA;AACA,kDAAkD,yBAAyB,IAAI,mEAAc,eAAe;AAC5G;AACA;AACA;AACA;AACA,4BAA4B,qBAAqB;AACjD;AACA;AACA,oDAAoD,wBAAwB,IAAI,qBAAqB;AACrG;AACA;AACA,2BAA2B,SAAS,QAAQ,WAAW;AACvD;AACA;AACA;AACA,8BAA8B,mEAAc,6BAA6B;AACzE;AACA;AACA,sDAAsD,0BAA0B,IAAI,mEAAc,6BAA6B;AAC/H;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mEAAc,2BAA2B;AACrE;AACA;AACA,oDAAoD,wBAAwB,IAAI,mEAAc,2BAA2B;AACzH;AACA;AACA;AACA;AACA;AACA,mFAAmF,sBAAsB;AACzG;AACA;AACO;AACP,IAAI,6CAAC,uCAAuC,iCAAiC;AAC7E,IAAI,6CAAC;AACL;AACA;AACO;AACP;AACA,IAAI,6CAAC,uBAAuB,uEAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oHAAoH;AACpH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAC,yBAAyB,uEAAiB;AAC/C;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA,IAAI,6CAAC;AACL;AACA;AACA,YAAY,6CAAC;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL,IAAI,6CAAC;AACL,QAAQ,4DAAO;AACf,KAAK;AACL;AACO;AACP;AACA,IAAI,oOAAmD;AACvD;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,2EAAqB;AACzB;AACA;AACA;AACA,KAAK;AACL,IAAI,2EAAqB;AACzB;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACO;AACP;AACA;AACA,YAAY,mGAA6C;AACzD;AACA;AACA;AACA;AACA,YAAY,mGAA6C;AACzD;AACA,YAAY,6CAAC,uCAAuC,iCAAiC;AACrF;AACA,YAAY,6CAAC;AACb;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,YAAY,6CAAC;AACb,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,6CAAC;AAC7B;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,KAAK;AACL;AACA,wBAAwB,yBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL","sources":["webpack://keeptrack.space/./src/js/plugins/nextLaunch/nextLaunch.ts"],"sourcesContent":["import { keepTrackApi } from '@app/js/api/keepTrackApi';\nimport { dateFormat } from '@app/js/lib/external/dateFormat.js';\nimport { saveCsv, truncateString } from '@app/js/lib/helpers';\nimport $ from 'jquery';\n/* */\nlet isNextLaunchMenuOpen = false;\n/**\n * @returns {HTMLTableElement | boolean} The Table Element to be modified in the UI or a false boolean to kill the parent method\n */\nexport const getTableElement = () => {\n    const tbl = document.getElementById('nextLaunch-table'); // Identify the table to update\n    if (tbl == null) {\n        return false;\n    }\n    return tbl;\n};\nexport const makeTableHeaders = (tbl) => {\n    const tr = tbl.insertRow();\n    const tdT = tr.insertCell();\n    tdT.appendChild(document.createTextNode('Launch Window'));\n    tdT.setAttribute('style', 'text-decoration: underline; width: 120px;');\n    const tdN = tr.insertCell();\n    tdN.appendChild(document.createTextNode('Mission'));\n    tdN.setAttribute('style', 'text-decoration: underline; width: 140px;');\n    const tdL = tr.insertCell();\n    tdL.appendChild(document.createTextNode('Location'));\n    tdL.setAttribute('style', 'text-decoration: underline');\n    const tdA = tr.insertCell();\n    tdA.appendChild(document.createTextNode('Agency'));\n    tdA.setAttribute('style', 'text-decoration: underline');\n    const tdC = tr.insertCell();\n    tdC.appendChild(document.createTextNode('Country'));\n    tdC.setAttribute('style', 'text-decoration: underline');\n};\nexport const initTable = (tbl, launchList) => {\n    makeTableHeaders(tbl);\n    for (let i = 0; i < launchList.length; i++) {\n        const tr = tbl.insertRow();\n        // Time Cells\n        const tdT = tr.insertCell();\n        let timeText;\n        if (launchList[i].windowStart.valueOf() <= Date.now() - 1000 * 60 * 60 * 24) {\n            timeText = 'TBD';\n        }\n        else {\n            timeText = dateFormat(launchList[i].windowStart, 'isoDateTime', true) + ' UTC';\n        }\n        tdT.appendChild(document.createTextNode(timeText));\n        // Name Cells\n        const tdN = tr.insertCell();\n        // Mission Name Text\n        const nameText = typeof launchList[i].missionName != 'undefined' ? launchList[i].missionName : 'Unknown';\n        // Mission Name HTML Setup\n        let nameHTML;\n        if (typeof launchList[i].missionURL == 'undefined' || launchList[i].missionURL == '') {\n            nameHTML = `${truncateString(nameText, 15)}`;\n        }\n        else {\n            nameHTML = `<a class='iframe' href=\"${launchList[i].missionURL}\">${truncateString(nameText, 15)}</a>`;\n        }\n        // Rocket Name HTML Setup\n        let rocketHTML;\n        if (typeof launchList[i].rocketURL == 'undefined') {\n            rocketHTML = `${launchList[i].rocket}`;\n        }\n        else {\n            rocketHTML = `<a class='iframe' href=\"${launchList[i].rocketURL}\">${launchList[i].rocket}</a>`;\n        }\n        // Set Name and Rocket HTML\n        tdN.innerHTML = `${nameHTML}<br />${rocketHTML}`;\n        // Location Name HTML Setup\n        let locationHTML;\n        if (typeof launchList[i].locationURL == 'undefined' || launchList[i].locationURL == '') {\n            locationHTML = `${truncateString(launchList[i].location, 25)}`;\n        }\n        else {\n            locationHTML = `<a class='iframe' href=\"${launchList[i].locationURL}\">${truncateString(launchList[i].location, 25)}</a>`;\n        }\n        const tdL = tr.insertCell();\n        tdL.innerHTML = locationHTML;\n        // Agency Name HTML Setup\n        let agencyHTML;\n        if (typeof launchList[i].agencyURL == 'undefined') {\n            agencyHTML = `${truncateString(launchList[i].agency, 30)}`;\n        }\n        else {\n            agencyHTML = `<a class='iframe' href=\"${launchList[i].agencyURL}\">${truncateString(launchList[i].agency, 30)}</a>`;\n        }\n        const tdA = tr.insertCell();\n        tdA.innerHTML = agencyHTML;\n        // Country Cell\n        const tdC = tr.insertCell();\n        tdC.innerHTML = `<span class=\"badge dark-blue-badge\" data-badge-caption=\"${launchList[i].country}\"></span>`;\n    }\n};\nexport const hideSideMenus = () => {\n    $('#nextLaunch-menu').effect('slide', { direction: 'left', mode: 'hide' }, 1000);\n    $('#menu-nextLaunch').removeClass('bmenu-item-selected');\n    isNextLaunchMenuOpen = false;\n};\nexport const uiManagerInit = () => {\n    // Side Menu\n    $('#left-menus').append(keepTrackApi.html `\n      <div id=\"nextLaunch-menu\" class=\"side-menu-parent start-hidden text-select\">\n        <div id=\"nextLaunch-content\" class=\"side-menu\">\n          <div class=\"row\">\n            <h5 class=\"center-align\">Next Launches</h5>\n            <table id=\"nextLaunch-table\" class=\"center-align striped-light centered\"></table>\n          </div>\n          <div class=\"row\">\n            <center>\n              <button id=\"export-launch-info\" class=\"btn btn-ui waves-effect waves-light\">Export Launch Info &#9658;</button>\n            </center>\n          </div>\n        </div>\n      </div>\n    `);\n    // Bottom Icon\n    $('#bottom-icons').append(keepTrackApi.html `\n        <div id=\"menu-nextLaunch\" class=\"bmenu-item\">\n          <img alt=\"calendar\" src=\"\" delayedsrc=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAABNUlEQVR4nO3cQWrCQBiAUS29Tne9/wm680C6Erow0GBnvtG8txQxkY8/jBP1dAIAAADgKM4zD/b1c70+evzyfZ56HncrnM/HrAPxmACxp0Zta4SP5plLlgmICRATICZATIDY54gX3VoVrPDB57e95zNi1WcCYgLEhlyCtlSXmi0rnI8JiAkQG3IJskf0dyYgJkBMgJgAMQFiU/eCXp29oDckQEyAmAAxAWJTt6P3+q87VivfoTMBMQFiAsQEiAkQW3oVtHc1Mvr5I5iAmAAxAWICxASITV0Frba3Yy8IAWoCxASICRAb8kv5FfZYRhjxfk1ATICYADEBYgLEDr0XtAITEBMgJkBMgJgAsaX/rOMVv+ezlwmICRATICZATICY/wuKmYCYADEBYgLEBAAAAAAAgPd3AzYrWtKgtEhrAAAAAElFTkSuQmCC\"> <!-- // NO-PIG -->\n          <span class=\"bmenu-title\">Next Launches</span>\n          <div class=\"status-icon\"></div>\n        </div>\n      `);\n    $('#nextLaunch-menu').resizable({\n        handles: 'e',\n        stop: function () {\n            $(this).css('height', '');\n        },\n        maxWidth: 650,\n        minWidth: 450,\n    });\n    $('#export-launch-info').on('click', function () {\n        saveCsv(nextLaunchManager.launchList, 'launchList');\n    });\n};\nexport const init = () => {\n    // Load CSS\n    import('@app/js/plugins/nextLaunch/nextLaunch.css').then((resp) => resp);\n    // Add HTML\n    keepTrackApi.register({\n        method: 'uiManagerInit',\n        cbName: 'nextLaunchManager',\n        cb: uiManagerInit,\n    });\n    // Add JavaScript\n    keepTrackApi.register({\n        method: 'bottomMenuClick',\n        cbName: 'nextLaunch',\n        cb: bottomMenuClick,\n    });\n    keepTrackApi.register({\n        method: 'hideSideMenus',\n        cbName: 'nextLaunch',\n        cb: hideSideMenus,\n    });\n    keepTrackApi.register({\n        method: 'onCruncherReady',\n        cbName: 'nextLaunch',\n        cb: () => {\n            nextLaunchManager.init();\n        },\n    });\n};\nexport const bottomMenuClick = (iconName) => {\n    if (iconName === 'menu-nextLaunch') {\n        if (isNextLaunchMenuOpen) {\n            keepTrackApi.programs.uiManager.hideSideMenus();\n            isNextLaunchMenuOpen = false;\n            return;\n        }\n        else {\n            keepTrackApi.programs.uiManager.hideSideMenus();\n            nextLaunchManager.showTable();\n            $('#nextLaunch-menu').effect('slide', { direction: 'left', mode: 'show' }, 1000);\n            isNextLaunchMenuOpen = true;\n            $('#menu-nextLaunch').addClass('bmenu-item-selected');\n            return;\n        }\n    }\n};\nexport const nextLaunchManager = {\n    launchList: [],\n    init: () => {\n        if (settingsManager.offline)\n            $('#menu-nextLaunch').hide();\n    },\n    showTable: () => {\n        if (nextLaunchManager.launchList.length === 0) {\n            if (window.location.hostname !== 'localhost') {\n                fetch('https://ll.thespacedevs.com/2.0.0/launch/upcoming/?format=json&limit=20&mode=detailed')\n                    .then((resp) => resp.json())\n                    .then((data) => nextLaunchManager.processData(data))\n                    .catch(() => console.debug(`https://ll.thespacedevs.com/2.0.0/ is Unavailable!`))\n                    .finally(() => {\n                    const tbl = getTableElement();\n                    if (typeof tbl == 'boolean')\n                        return;\n                    // Only needs populated once\n                    if (tbl.innerHTML == '') {\n                        initTable(tbl, nextLaunchManager.launchList);\n                        try {\n                            $('a.iframe').colorbox({\n                                iframe: true,\n                                width: '80%',\n                                height: '80%',\n                                fastIframe: false,\n                                closeButton: false,\n                            });\n                        }\n                        catch (error) {\n                            console.warn(error);\n                        }\n                    }\n                });\n            }\n        }\n    },\n    processData: (resp) => {\n        for (let i = 0; i < resp.results.length; i++) {\n            /**\n             * Info from launchlibrary.net\n             */\n            const launchLibResult = resp.results[i];\n            const launchInfo = {\n                name: '',\n                updated: null,\n                windowStart: new Date(launchLibResult.window_start),\n                windowEnd: new Date(launchLibResult.window_end),\n                location: '',\n                locationURL: '',\n                agency: '',\n                agencyURL: '',\n                country: '',\n                mission: '',\n                missionName: '',\n                missionType: '',\n                missionURL: '',\n                rocket: '',\n                rocketConfig: '',\n                rocketFamily: '',\n                rocketURL: '',\n            };\n            if (typeof launchLibResult.last_updated !== 'undefined')\n                launchInfo.updated = new Date(launchLibResult.last_updated);\n            launchInfo.name = typeof launchLibResult.name != 'undefined' ? launchLibResult.name : 'Unknown';\n            launchInfo.location = launchLibResult.pad.location.name.split(',', 1);\n            launchInfo.location = launchInfo.location[0];\n            launchInfo.locationURL = launchLibResult.pad.wiki_url;\n            if (typeof launchLibResult.launch_service_provider != 'undefined') {\n                launchInfo.agency = typeof launchLibResult.launch_service_provider.name != 'undefined' ? launchLibResult.launch_service_provider.name : 'Unknown';\n                launchInfo.country = typeof launchLibResult.launch_service_provider.country_code != 'undefined' ? launchLibResult.launch_service_provider.country_code : 'Unknown';\n                if (typeof launchLibResult.launch_service_provider.wiki_url != 'undefined') {\n                    launchInfo.agencyURL = launchLibResult.launch_service_provider.wiki_url;\n                }\n            }\n            else {\n                launchInfo.agency = 'Unknown';\n                launchInfo.country = 'UNK';\n                launchInfo.agencyURL = '';\n            }\n            if (launchLibResult.mission != null) {\n                launchInfo.mission = launchLibResult.mission.description;\n                launchInfo.missionName = launchLibResult.mission.name;\n                launchInfo.missionType = launchLibResult.mission.type;\n                if (typeof launchLibResult.mission.wiki_url != 'undefined') {\n                    launchInfo.missionURL = launchLibResult.mission.wiki_url;\n                }\n            }\n            launchInfo.rocket = launchLibResult.rocket.configuration.full_name;\n            launchInfo.rocketConfig = launchLibResult.rocket.configuration.name;\n            launchInfo.rocketFamily = launchLibResult.rocket.configuration.family;\n            if (typeof launchLibResult.rocket.configuration.wiki_url != 'undefined') {\n                launchInfo.rocketURL = launchLibResult.rocket.configuration.wiki_url;\n            }\n            nextLaunchManager.launchList[i] = launchInfo;\n        }\n    },\n};\n"],"names":[],"sourceRoot":""}